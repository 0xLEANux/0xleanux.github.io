<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <link rel="manifest" href="/donate/manifest.webmanifest">
  <link rel="icon" href="/donate/favicon.svg" type="image/svg+xml">
  <meta name="theme-color" content="#070814">
  <title>Donate • 0xElectron + 0xLEANux</title>

  <!--
    - Background gradient is fixed (body::before). Only the content scrolls.
    - Responsive: desktop table + mobile cards + fluid typography.
    - Dual recipients: @0xElectron (DEV) and @0xLEANux (ORG) with deep-link (?to=dev / ?to=org).
    - Includes an “Arch Corner” with tips/cheatsheet + playful extras.
  -->

  <style>
    :root{
      --bg0:#02030a;
      --bg1:#03040d;
      --bg2:#050614;
      --bg-layers:
        radial-gradient(1200px 580px at 14% 10%, rgba(183,107,255,.10), transparent 60%),
        radial-gradient(1000px 560px at 90% 0%, rgba(0,229,255,.065), transparent 60%),
        radial-gradient(980px 560px at 40% 120%, rgba(255,107,214,.04), transparent 60%),
        radial-gradient(780px 520px at 78% 120%, rgba(124,255,158,.03), transparent 62%),
        linear-gradient(180deg, var(--bg2), var(--bg0));

      --panel: rgba(255,255,255,.045);
      --panel2: rgba(0,0,0,.34);

      --stroke: rgba(255,255,255,.08);
      --stroke2: rgba(255,255,255,.07);

      --text: rgba(245,245,255,.92);
      --muted: rgba(245,245,255,.70);
      --muted2: rgba(245,245,255,.54);

      /* RGB palette */
      --c1:#b76bff; /* neon purple */
      --c2:#00e5ff; /* cyan */
      --c3:#7CFF9E; /* mint */
      --c4:#FF6BD6; /* pink */
      --edgeGradient: linear-gradient(120deg,
        rgba(183,107,255,.58),
        rgba(0,229,255,.54),
        rgba(124,255,158,.48),
        rgba(255,107,214,.52),
        rgba(183,107,255,.58)
      );
      --glowA: rgba(183,107,255,.08);
      --glowB: rgba(0,229,255,.08);
      --brandDefault: rgba(255,255,255,.16);

      --good: rgba(124,255,158,.16);
      --warn: rgba(255,210,120,.16);
      --danger: rgba(255,120,170,.14);

      --r: 20px;
      --r2: 14px;
      --r3: 12px;

      --shadow: 0 20px 70px rgba(0,0,0,.55);
      --shadow2: 0 14px 48px rgba(0,0,0,.42);

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial;

      --lh: 1.58;

      /* Fluid typography */
      --t0: clamp(12px, 0.9vw, 13px);
      --t1: clamp(13px, 1.0vw, 14px);
      --t2: clamp(14px, 1.15vw, 15.5px);
      --t3: clamp(16px, 1.4vw, 18px);
      --t4: clamp(22px, 2.4vw, 30px);
      --t5: clamp(28px, 3.6vw, 44px);

      --max: 1600px;
      --pad: 16px;

      --ease: cubic-bezier(.2,.8,.2,1);
      --dur: 130ms;
      --dur2: 220ms;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background: var(--bg0);
      overflow-x:hidden;
    }

    /* Fixed background gradient (constant) */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      z-index: -2;
      background: var(--bg-layers);
      transform: translateZ(0);
    }

    /* Noise layer to avoid banding */
    body::after{
      content:"";
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events:none;
      opacity: .07;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.55'/%3E%3C/svg%3E");
      background-size: 120px 120px;
    }

    a{ color:inherit; text-decoration:none; }
    img{ max-width:100%; display:block; }

    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 18px var(--pad) 72px;
    }

    .srOnly{
      position:absolute; width:1px; height:1px; padding:0; margin:-1px;
      overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
    }

    /* Reveal animations + copy pulses */
    .reveal{ opacity:0; transform: translateY(12px); transition: opacity 320ms var(--ease), transform 320ms var(--ease); }
    .reveal.visible{ opacity:1; transform:none; }
    @keyframes pulseCopy{
      0%{ transform: translateY(0); box-shadow: 0 0 0 0 rgba(0,229,255,.30); }
      100%{ transform: translateY(-1px); box-shadow: 0 0 0 8px rgba(0,229,255,0); }
    }
    .pulse{ animation: pulseCopy 360ms var(--ease); }

    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; scroll-behavior:auto !important; }
    }

    /* RGB border / glass */
    .rgb{
      position: relative;
      border-radius: var(--r);
      isolation: isolate;
      overflow:hidden;
    }
    .rgb::before{
      content:"";
      position:absolute;
      inset:-2px;
      border-radius: inherit;
      background: linear-gradient(120deg,
        rgba(183,107,255,.70),
        rgba(0,229,255,.55),
        rgba(124,255,158,.35),
        rgba(255,107,214,.35)
      );
      background-size: 220% 220%;
      filter: blur(12px);
      opacity: .48;
      z-index: -2;
      animation: hue 12s linear infinite, borderFlow 24s linear infinite;
    }
    .rgb::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      background: rgba(6,7,22,.68);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      z-index: -1;
    }
    @keyframes hue{
      0%{ filter: blur(12px) hue-rotate(0deg); }
      100%{ filter: blur(12px) hue-rotate(360deg); }
    }
    @keyframes borderFlow{
      0%{ background-position: 0% 50%; }
      100%{ background-position: 200% 50%; }
    }

    .panel{ padding: 18px; box-shadow: var(--shadow2); }
    .subPanel{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      padding: 14px;
    }

    /* Sticky top bar */
    header{
      position: sticky;
      top:0;
      z-index: 60;
      backdrop-filter: blur(12px);
      background: linear-gradient(180deg, rgba(6,7,22,.80), rgba(6,7,22,.36));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .top{
      max-width: var(--max);
      margin: 0 auto;
      padding: 12px var(--pad);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 260px;
      flex: 1 1 360px;
    }
    .logo{
      width: 42px; height: 42px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(183,107,255,.95), rgba(0,229,255,.75));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 16px 46px rgba(0,0,0,.48);
      flex: 0 0 auto;
      position: relative;
      overflow:hidden;
    }
    .logo::after{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%);
      transform: rotate(18deg);
      opacity:.35;
    }
    .brandText{ min-width:0; }
    .brandTitle{
      margin:0;
      font-size: var(--t2);
      letter-spacing: .10em;
      text-transform: uppercase;
      color: rgba(245,245,255,.82);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brandSub{
      margin:2px 0 0;
      font-size: var(--t0);
      color: rgba(245,245,255,.55);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .topRight{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:flex-end;
      flex: 1 1 520px;
      flex-wrap: wrap;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      font-size: var(--t1);
      color: rgba(245,245,255,.82);
    }
    .pill code{
      font-family: var(--mono);
      font-size: 12px;
      color: rgba(245,245,255,.92);
    }

    .seg{
      display:inline-flex;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.24);
      overflow:hidden;
    }
    .seg button{
      border:0;
      background: transparent;
      color: rgba(245,245,255,.72);
      padding: 9px 12px;
      cursor:pointer;
      font-size: var(--t1);
      font-weight: 950;
      transition: background var(--dur) var(--ease), color var(--dur) var(--ease);
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .seg button:hover{
      background: rgba(255,255,255,.06);
      color: rgba(245,245,255,.92);
    }
    .seg button.active{
      background: linear-gradient(135deg, rgba(183,107,255,.28), rgba(0,229,255,.18));
      color: rgba(245,245,255,.95);
    }
    .badge{
      font-family: var(--mono);
      font-size: 11.5px;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
    }

    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-weight: 950;
      font-size: var(--t2);
      cursor:pointer;
      user-select:none;
      transition:
        transform var(--dur) var(--ease),
        border-color var(--dur) var(--ease),
        background var(--dur) var(--ease),
        box-shadow var(--dur2) var(--ease),
        filter var(--dur2) var(--ease);
      will-change: transform;
      position: relative;
      overflow:hidden;
    }
    .btn::after{
      content:"";
      position:absolute;
      inset:-60%;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.22), transparent 55%);
      transform: rotate(12deg);
      opacity: 0;
      transition: opacity var(--dur2) var(--ease);
      pointer-events:none;
    }
    .btn:hover{
      transform: translateY(-1px) scale(1.01);
      border-color: rgba(255,255,255,.24);
      background: rgba(255,255,255,.085);
      box-shadow: 0 18px 60px rgba(0,0,0,.34);
      filter: saturate(1.05);
    }
    .btn:hover::after{ opacity: .9; }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn:focus-visible,
    .seg button:focus-visible,
    .filterBtn:focus-visible,
    input:focus-visible{
      outline: 2px solid rgba(0,229,255,.72);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(0,229,255,.16);
    }

    .btnPrimary{
      color:#060713;
      border-color: rgba(255,255,255,.16);
      background: linear-gradient(135deg, rgba(183,107,255,.98), rgba(0,229,255,.72));
    }
    .btnPrimary:hover{
      background: linear-gradient(135deg, rgba(183,107,255,.99), rgba(0,229,255,.82));
      box-shadow: 0 22px 70px rgba(0,0,0,.38);
    }
    .btnGhost{ background: rgba(0,0,0,.26); border-color: rgba(255,255,255,.12); }
    .btnSm{ padding: 9px 10px; font-size: var(--t1); border-radius: 12px; font-weight: 900; }

    .btn[aria-disabled="true"]{
      opacity: .48;
      cursor:not-allowed;
      transform:none !important;
      box-shadow:none !important;
      filter:none !important;
    }

    /* Hero */
    .hero{ margin-top: 16px; padding: 22px; }
    .hero h1{
      margin: 0 0 8px;
      font-size: var(--t5);
      letter-spacing: -.03em;
      line-height: 1.06;
    }
    .hero p{
      margin: 0;
      font-size: var(--t2);
      color: var(--muted);
      line-height: var(--lh);
      max-width: 90ch;
    }

    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 12px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      font-size: var(--t0);
      color: rgba(245,245,255,.82);
    }
    .chip.good{ background: var(--good); border-color: rgba(124,255,158,.22); }
    .chip.warn{ background: var(--warn); border-color: rgba(255,210,120,.22); }
    .chip.danger{ background: var(--danger); border-color: rgba(255,120,170,.18); }

    .heroGrid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 14px;
      margin-top: 16px;
    }
    @media (max-width: 980px){
      .heroGrid{ grid-template-columns: 1fr; }
    }

    .ctaRow{
      display:flex;
      flex-wrap: wrap;
      gap:10px;
      align-items:center;
      margin-top: 14px;
    }
    .ctaRow .btn{
      animation: ctaIn 260ms var(--ease) both;
    }
    .ctaRow .btn:nth-child(1){ animation-delay: 40ms; }
    .ctaRow .btn:nth-child(2){ animation-delay: 80ms; }
    .ctaRow .btn:nth-child(3){ animation-delay: 120ms; }
    .ctaRow .btn:nth-child(4){ animation-delay: 160ms; }

    .metaStrip{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-top: 14px;
      padding: 12px;
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        linear-gradient(120deg, rgba(255,255,255,.04), rgba(0,0,0,.18)) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, border-box;
      background-size: 180% 180%;
      animation: borderFlow 18s linear infinite;
      box-shadow: 0 10px 28px rgba(0,0,0,.26), 0 0 0 1px rgba(255,255,255,.04), 0 0 18px var(--glowA), 0 0 26px var(--glowB);
    }
    .metaItem{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }
    .metaLabel{
      font-size: var(--t0);
      letter-spacing: .08em;
      text-transform: uppercase;
      color: rgba(245,245,255,.60);
    }
    .metaValue{
      font-size: var(--t3);
      font-weight: 950;
      color: rgba(245,245,255,.95);
      letter-spacing: .01em;
    }
    .metaNote{
      font-size: var(--t1);
      color: rgba(245,245,255,.68);
      line-height: 1.45;
    }
    .impactStrip{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px;
    }
    .impactCard{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(255,255,255,.04), rgba(0,0,0,.14));
      padding: 12px;
      box-shadow: 0 12px 32px rgba(0,0,0,.24);
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease);
    }
    .impactCard:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.18); }
    .impactTitle{
      margin:0;
      font-size: var(--t2);
      font-weight: 950;
      letter-spacing: .01em;
    }
    .impactText{
      margin:6px 0 0;
      font-size: var(--t1);
      color: rgba(245,245,255,.70);
      line-height: 1.5;
    }
    .kpiGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 12px;
    }
    @media (max-width: 720px){
      .kpiGrid{ grid-template-columns: 1fr; }
    }
    .kpi{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      padding: 12px;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease);
    }
    .kpi:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    .kpi .label{
      font-size: var(--t0);
      color: rgba(245,245,255,.60);
      letter-spacing: .06em;
      text-transform: uppercase;
    }
    .kpi .value{
      margin-top: 6px;
      font-size: var(--t3);
      font-weight: 950;
      letter-spacing: -.01em;
    }
    .kpi .desc{
      margin-top: 4px;
      font-size: var(--t0);
      color: rgba(245,245,255,.55);
      line-height: 1.45;
    }

    .h2{
      margin: 0 0 8px;
      font-size: var(--t3);
      letter-spacing: .01em;
      color: rgba(245,245,255,.92);
    }
    .pMuted{
      margin: 0;
      color: var(--muted2);
      font-size: var(--t1);
      line-height: var(--lh);
    }
    .mono{ font-family: var(--mono); }

    .fineprint{
      margin-top: 12px;
      color: rgba(245,245,255,.55);
      font-size: var(--t0);
      line-height: 1.45;
    }

    /* Main grid */
    .mainGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      margin-top: 14px;
    }
    @media (max-width: 980px){
      .mainGrid{ grid-template-columns: 1fr; }
    }

    /* Offerings */
    .offerGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 980px){
      .offerGrid{ grid-template-columns: 1fr; }
    }
    .offer{
      --offer-a: rgba(183,107,255,.24);
      --offer-b: rgba(0,229,255,.18);
      --offer-outline: rgba(255,255,255,.12);
      position: relative;
      z-index: 0;
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        radial-gradient(140% 120% at 12% 18%, var(--offer-a), transparent 55%) padding-box,
        radial-gradient(120% 140% at 86% 16%, var(--offer-b), transparent 55%) padding-box,
        linear-gradient(160deg, rgba(255,255,255,.04), rgba(255,255,255,.01)) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, padding-box, padding-box, border-box;
      background-size: 150% 150%;
      animation: borderFlow 14s linear infinite;
      padding: 14px;
      overflow:hidden;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), box-shadow var(--dur2) var(--ease), filter var(--dur2) var(--ease), background-size var(--dur2) var(--ease);
      box-shadow: 0 12px 36px rgba(0,0,0,.32), 0 0 0 1px rgba(255,255,255,.05), 0 0 16px var(--glowA), 0 0 24px var(--glowB);
      background-position: 0% 0%;
    }
    .offer[data-tone="cyan"]{
      --offer-a: rgba(0,229,255,.22);
      --offer-b: rgba(124,255,158,.18);
      --offer-outline: rgba(0,229,255,.16);
    }
    .offer[data-tone="mint"]{
      --offer-a: rgba(124,255,158,.20);
      --offer-b: rgba(255,107,214,.14);
      --offer-outline: rgba(124,255,158,.16);
    }
    .offer::before{
      content:"";
      position:absolute;
      inset:-2px;
      opacity: .55;
      background: linear-gradient(120deg, var(--offer-a), var(--offer-b));
      filter: blur(12px);
      transition: opacity var(--dur2) var(--ease);
      pointer-events:none;
      z-index:-1;
    }
    .offer::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.01));
      opacity: .25;
      pointer-events:none;
    }
    .offer:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.20);
      box-shadow: 0 18px 60px rgba(0,0,0,.40), 0 0 0 1px rgba(255,255,255,.06), 0 0 24px var(--glowA), 0 0 36px var(--glowB);
      filter: saturate(1.05);
      background-size: 165% 165%;
      background-position: 20% 20%;
    }
    .offer:hover::before{ opacity:.85; }
    .offer > *{ position:relative; }

    .offerHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .offer h3{
      margin:0;
      font-size: var(--t2);
      font-weight: 950;
      letter-spacing: .01em;
      color: rgba(245,245,255,.96);
    }
    .price{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-family: var(--mono);
      font-size: var(--t2);
      color: rgba(6,7,19,.92);
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: linear-gradient(140deg, rgba(255,255,255,.85), rgba(255,255,255,.65));
      box-shadow: 0 12px 32px rgba(0,0,0,.32);
      white-space: nowrap;
      min-width: 88px;
      position: relative;
      /* overflow:hidden; */
    }
    .price::after{
      content:"";
      position:absolute;
      inset:-40% 60% auto auto;
      width: 60%;
      height: 200%;
      background: linear-gradient(135deg, rgba(255,255,255,.45), rgba(255,255,255,0));
      transform: skewX(-20deg);
      opacity:0;
      transition: opacity var(--dur) var(--ease), transform var(--dur2) var(--ease);
      pointer-events:none;
    }
    .offer:hover .price::after{ opacity:.8; transform: translateX(-80%) skewX(-20deg); }
    .offer .desc{
      margin-top: 10px;
      font-size: var(--t1);
      color: rgba(245,245,255,.72);
      line-height: 1.48;
    }
    .btnIcon{
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .miniBrandIcon{
      width: 20px;
      height: 20px;
      border-radius: 6px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size: 10px;
      font-weight: 800;
      color: #050614;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.32), transparent 55%),
        linear-gradient(135deg, var(--brand-color, #999), rgba(0,0,0,.10));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 6px 16px rgba(0,0,0,.24);
      overflow:hidden;
    }
    .miniBrandIcon img{ width:100%; height:100%; object-fit:contain; display:block; }
    .miniBrandIcon.imgOnly{
      background: transparent;
      border: 0;
      box-shadow: none;
      width: 20px;
      height: 20px;
      padding: 0;
    }

    .splitActions{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 560px){
      .splitActions{ grid-template-columns: 1fr; }
    }

    .miniCard{
      --mini-a: rgba(255,255,255,.05);
      --mini-b: rgba(255,255,255,.02);
      border-radius: var(--r3);
      border: 1px solid transparent;
      background:
        linear-gradient(145deg, var(--mini-a), var(--mini-b)) padding-box,
        rgba(0,0,0,.20) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, padding-box, border-box;
      background-size: 140% 140%;
      animation: borderFlow 18s linear infinite;
      padding: 10px;
      box-shadow: 0 10px 28px rgba(0,0,0,.26), 0 0 0 1px rgba(255,255,255,.04), 0 0 12px var(--glowA), 0 0 16px var(--glowB);
    }
    .miniDev{ --mini-a: rgba(183,107,255,.14); --mini-b: rgba(0,0,0,.12); }
    .miniOrg{ --mini-a: rgba(0,229,255,.12); --mini-b: rgba(0,0,0,.12); }
    .miniHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 8px;
    }
    .miniHead .who{
      font-weight: 950;
      font-size: var(--t1);
      color: rgba(245,245,255,.86);
    }
    .miniHead .tag{
      font-family: var(--mono);
      font-size: 11.5px;
      color: rgba(245,245,255,.78);
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
    }
    .miniDev .tag{ border-color: rgba(183,107,255,.32); background: rgba(183,107,255,.12); }
    .miniOrg .tag{ border-color: rgba(0,229,255,.30); background: rgba(0,229,255,.10); }
    .miniBtns{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
    }

    /* Filters + methods */
    .filters{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    .search{
      display:flex;
      gap:10px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(255,255,255,.04), rgba(0,0,0,.18));
      min-width: 320px;
      flex: 1 1 360px;
      box-shadow: 0 10px 28px rgba(0,0,0,.25);
    }
    .search:focus-within{ border-color: rgba(0,229,255,.28); box-shadow: 0 14px 40px rgba(0,0,0,.32); }
    .search input{
      border:0;
      outline:0;
      width:100%;
      background: transparent;
      color: rgba(245,245,255,.92);
      font-size: var(--t2);
    }
    .toggle{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(255,255,255,.03), rgba(0,0,0,.20));
      color: rgba(245,245,255,.82);
      font-size: var(--t1);
      user-select:none;
      flex: 0 0 auto;
    }
    .toggle input{ width:16px; height:16px; }
    .filterTabs{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap: wrap;
    }
    .currencySwitch{
      display:flex;
      gap: 6px;
      align-items:center;
      flex-wrap: wrap;
    }
    .filterBtn{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: rgba(245,245,255,.80);
      padding: 8px 11px;
      border-radius: 999px;
      font-size: var(--t1);
      cursor: pointer;
      transition: border-color var(--dur) var(--ease), background var(--dur) var(--ease), transform var(--dur) var(--ease);
    }
    .filterBtn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    .filterBtn.active{
      border-color: rgba(0,229,255,.30);
      background: linear-gradient(135deg, rgba(0,229,255,.16), rgba(255,255,255,.05));
      color: rgba(245,245,255,.95);
    }

    .tableWrap{
      overflow:auto;
      max-height: 667px; /* ~8 rows visible before scroll */
      margin-top: 12px;
      border-radius: var(--r2);
      border: 1px solid var(--stroke2);
      background: rgba(0,0,0,.18);
      box-shadow: 0 18px 48px rgba(0,0,0,.32);
    }
    table{
      width:100%;
      border-collapse: separate;
      border-spacing: 0;
      min-width: 1040px;
      font-size: var(--t2);
    }
    thead th{
      text-align:left;
      padding: 12px;
      font-size: var(--t0);
      text-transform: uppercase;
      letter-spacing: .10em;
      color: rgba(245,245,255,1);
      background: rgba(0,0,0,.30);
      border-bottom: 1px solid var(--stroke2);
      position: sticky;
      top: 0;
      z-index: 2;
      backdrop-filter: blur(8px);
      box-shadow: 0 8px 22px rgba(0,0,0,.25);
    }
    tbody td{
      padding: 12px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      vertical-align: top;
      color: rgba(245,245,255,.86);
      position: relative;
      z-index: 1;
    }
    tbody tr{
      position: relative;
      transition: transform var(--dur) var(--ease), box-shadow var(--dur2) var(--ease), opacity 200ms var(--ease);
    }
    tbody tr:hover td{ background: rgba(255,255,255,.04); }
    tbody tr:hover{
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0,0,0,.28);
    }
    tbody tr:hover td{
      background: linear-gradient(90deg, var(--brand-fade, rgba(255,255,255,.06)), rgba(255,255,255,.02));
    }
    tbody tr[data-configured="1"] td{
      background-image:
        linear-gradient(90deg, var(--brand-fade, rgba(124,255,158,.02)), transparent),
        linear-gradient(90deg, rgba(124,255,158,.05), transparent);
    }
    tbody tr[data-configured="0"] td{
      background-image:
        linear-gradient(90deg, var(--brand-fade, rgba(255,107,214,.02)), transparent),
        linear-gradient(90deg, rgba(255,107,214,.05), transparent);
      color: rgba(245,245,255,.74);
    }

    .status{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: var(--t0);
      color: rgba(245,245,255,.85);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .pillBadge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,210,120,.18);
      background: linear-gradient(135deg, rgba(255,210,120,.14), rgba(255,255,255,.05));
      font-size: var(--t0);
      letter-spacing: .02em;
      color: rgba(245,245,255,.90);
      text-transform: uppercase;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background: rgba(255,255,255,.35); }
    .dot.on{ background: rgba(124,255,158,.90); }
    .dot.off{ background: rgba(255,120,170,.90); }
    tr[data-configured="1"] .status, .methodCard[data-configured="1"] .status{
      border-color: rgba(124,255,158,.28);
      background: rgba(124,255,158,.10);
    }
    tr[data-configured="0"] .status, .methodCard[data-configured="0"] .status{
      border-color: rgba(255,120,170,.30);
      background: rgba(255,120,170,.08);
    }

    .methodCards{
      display:none;
      margin-top: 12px;
      gap: 10px;
      grid-template-columns: 1fr;
    }
    .methodCard{
      --method-a: rgba(183,107,255,.14);
      --method-b: rgba(0,229,255,.10);
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        linear-gradient(120deg, var(--brand-fade, rgba(255,255,255,.02)), transparent) padding-box,
        radial-gradient(120% 120% at 12% 12%, var(--method-a), transparent 55%) padding-box,
        linear-gradient(150deg, rgba(255,255,255,.04), rgba(255,255,255,.02)) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, padding-box, border-box;
      background-size: 170% 170%;
      animation: borderFlow 16s linear infinite;
      padding: 12px;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), background-size var(--dur2) var(--ease), box-shadow var(--dur2) var(--ease);
      box-shadow: 0 12px 32px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.04), 0 0 14px var(--glowA), 0 0 18px var(--glowB);
    }
    .methodCard:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); background-size: 185% 185%; box-shadow: 0 16px 40px rgba(0,0,0,.34), 0 0 0 1px rgba(255,255,255,.06), 0 0 20px var(--glowA), 0 0 26px var(--glowB); }
    .methodCard[data-configured="0"]{
      --method-a: rgba(255,107,214,.12);
      --method-b: rgba(0,0,0,.08);
      border-style: dashed;
      opacity: .94;
    }
    .methodTop{ display:flex; align-items:flex-start; justify-content:space-between; gap: 10px; }
    .methodCell{
      display:flex;
      align-items:center;
      gap: 8px;
      min-width:0;
    }
    .brandIcon{
      flex:0 0 auto;
      width: 26px;
      height: 26px;
      border-radius: 9px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight: 950;
      font-size: 13px;
      color: #050614;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.32), transparent 55%),
        linear-gradient(135deg, var(--brand-color, var(--brandDefault)), rgba(0,0,0,.08));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 8px 22px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.04);
    }
    .brandName{
      font-weight: 950;
      font-size: var(--t2);
      color: rgba(245,245,255,.95);
    }
    .methodMeta{
      margin-top: 6px;
      font-size: var(--t0);
      color: rgba(245,245,255,.60);
      letter-spacing: .06em;
      text-transform: uppercase;
    }
    .methodNote{
      margin-top: 10px;
      font-size: var(--t1);
      color: rgba(245,245,255,.64);
      line-height: 1.48;
    }
    .methodActions{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
    }
    @media (max-width: 860px){
      .tableWrap{ display:none; }
      .methodCards{ display:grid; }
    }

    /* Right column blocks */
    .addrBox{
      margin-top: 12px;
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        linear-gradient(145deg, rgba(255,255,255,.03), rgba(0,0,0,.20)) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, border-box;
      background-size: 180% 180%;
      animation: borderFlow 18s linear infinite;
      padding: 12px;
      box-shadow: 0 12px 32px rgba(0,0,0,.28), 0 0 0 1px rgba(255,255,255,.05), 0 0 28px var(--glowA), 0 0 36px var(--glowB);
    }
    .addrLabel{
      font-size: var(--t0);
      color: rgba(245,245,255,.60);
      letter-spacing: .08em;
      text-transform: uppercase;
      margin-bottom: 6px;
    }
    .addrVal{
      font-family: var(--mono);
      font-size: 12.5px;
      color: rgba(245,245,255,.90);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .addrRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      margin-top: 12px;
    }
    .addrRow:first-child{ margin-top: 0; }
    .addrBtns{ display:flex; gap:8px; flex-wrap: wrap; flex: 0 0 auto; }
    .addrBadge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      font-size: var(--t0);
      letter-spacing: .04em;
    }

    .verifyBox{
      margin-top: 12px;
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        linear-gradient(135deg, rgba(124,255,158,.10), rgba(0,229,255,.08), rgba(255,255,255,.02)) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, border-box;
      background-size: 190% 190%;
      animation: borderFlow 16s linear infinite;
      padding: 12px;
      box-shadow: 0 12px 32px rgba(0,0,0,.24), 0 0 0 1px rgba(255,255,255,.06), 0 0 32px var(--glowA), 0 0 44px var(--glowB);
    }
    .verifyTitle{
      margin: 0 0 6px;
      font-size: var(--t2);
      font-weight: 950;
      color: rgba(245,245,255,.94);
    }
    .verifyRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      margin-top: 8px;
      padding: 8px 0;
      border-top: 1px solid rgba(255,255,255,.08);
    }
    .verifyRow:first-of-type{ border-top: 0; padding-top: 0; }
    .shortAddr{
      font-family: var(--mono);
      font-size: 12.5px;
      color: rgba(245,245,255,.88);
      letter-spacing: .02em;
    }
    .verifyNote{ margin-top: 8px; color: rgba(245,245,255,.70); font-size: var(--t1); line-height: var(--lh); }
    .verifyFine{ margin-top: 6px; color: rgba(245,245,255,.60); font-size: var(--t0); line-height: 1.45; }

    details{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      padding: 12px;
      margin-top: 10px;
      transition: border-color var(--dur) var(--ease), transform var(--dur) var(--ease);
    }
    details:hover{ border-color: rgba(255,255,255,.18); transform: translateY(-1px); }
    summary{
      cursor: pointer;
      font-weight: 950;
      font-size: var(--t2);
      color: rgba(245,245,255,.86);
      list-style:none;
    }
    summary::-webkit-details-marker{ display:none; }
    details p{
      margin: 10px 0 0;
      color: rgba(245,245,255,.64);
      font-size: var(--t1);
      line-height: var(--lh);
    }

    /* Arch Corner */
    .archGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    .archTip{
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        rgba(0,0,0,.22) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, border-box;
      background-size: 170% 170%;
      animation: borderFlow 20s linear infinite;
      padding: 12px;
      position: relative;
      overflow:hidden;
      box-shadow: 0 12px 34px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.04), 0 0 26px var(--glowA), 0 0 32px var(--glowB);
    }
    .archTip::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: linear-gradient(135deg, rgba(0,229,255,.10), rgba(183,107,255,.12), rgba(124,255,158,.08));
      opacity: 0;
      transition: opacity var(--dur2) var(--ease);
      pointer-events:none;
    }
    .archTip:hover::before{ opacity: 1; }
    .archTip > *{ position:relative; }
    .archTipTitle{
      font-weight: 950;
      font-size: var(--t2);
      margin: 0 0 6px;
    }
    .archTipText{
      margin: 0;
      color: rgba(245,245,255,.70);
      font-size: var(--t1);
      line-height: 1.5;
    }
    .cmdTop {
      display: flex;
      margin: auto;
      padding: 0;
      justify-content: space-between;
    }
    .cmdList{
      margin-top: 10px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 10px;
    }
    .cmd{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(135deg, rgba(255,255,255,.05), rgba(0,0,0,.18));
      padding: 10px;
      position: relative;
      overflow:hidden;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), box-shadow var(--dur2) var(--ease);
    }
    .cmd::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(120deg, rgba(0,229,255,.14), rgba(183,107,255,.12), rgba(124,255,158,.10));
      opacity: 0;
      transition: opacity var(--dur2) var(--ease);
      z-index:0;
    }
    .cmd:hover{
      transform: translateY(-2px);
      border-color: rgba(0,229,255,.28);
      box-shadow: 0 16px 32px rgba(0,0,0,.32);
    }
    .cmd:hover::before{ opacity: .24; }
    .cmd > *{ position:relative; z-index:1; }
    .cmdTop button.btn{ box-shadow:none; }
    .cmdTop button.btn:hover{ box-shadow:0 12px 30px rgba(0,0,0,.28); }
    .cmd:hover .cmdName{ color: rgba(245,245,255,.95); }
    .cmd:hover .cmdCode{ border-color: rgba(0,229,255,.28); }
    .cmdTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .cmdName{
      font-weight: 950;
      font-size: var(--t1);
      margin:0;
      color: rgba(245,245,255,.86);
    }
    .cmdDesc{
      margin: 6px 0 0;
      color: rgba(245,245,255,.62);
      font-size: var(--t0);
      line-height: 1.45;
    }
    .cmdCode{
      margin-top: 10px;
      font-family: var(--mono);
      font-size: 12.5px;
      color: rgba(245,245,255,.90);
      word-break: break-word;
      padding: 12px 12px 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.26);
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), box-shadow var(--dur2) var(--ease);
    }
    .cmdCodeWrap{
      margin-top: 8px;
      position: relative;
    }
    .cmdActions{
      display:flex;
      gap: 8px;
      align-items:center;
    }
    .cmdActions .cmdCopy{
      padding: 6px 10px;
      border-radius: 10px;
      font-size: var(--t0);
      font-weight: 800;
    }
    .cmd:hover .cmdCode{ transform: translateY(-1px); border-color: rgba(0,229,255,.20); box-shadow: 0 12px 28px rgba(0,0,0,.28); }

    /* Supporter wall */
    .wall{
      margin-top: 12px;
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 12px;
    }
    .wallGrid{
      margin-top: 10px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    @media (max-width: 980px){
      .wallGrid{ grid-template-columns: 1fr; }
    }
    .wallCard{
      border-radius: var(--r2);
      border: 1px solid transparent;
      background:
        rgba(255,255,255,.04) padding-box,
        var(--edgeGradient) border-box;
      background-clip: padding-box, border-box;
      background-size: 150% 150%;
      animation: borderFlow 16s linear infinite;
      padding: 12px;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), background-size var(--dur2) var(--ease), box-shadow var(--dur2) var(--ease);
      box-shadow: 0 12px 28px rgba(0,0,0,.26), 0 0 0 1px rgba(255,255,255,.04), 0 0 20px var(--glowA), 0 0 28px var(--glowB);
    }
    .wallCard:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.18); background-size: 170% 170%; box-shadow: 0 16px 34px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.06), 0 0 28px var(--glowA), 0 0 36px var(--glowB); }
    .wallName{ font-weight: 950; }
    .wallNote{ margin-top: 6px; color: rgba(245,245,255,.62); font-size: var(--t0); line-height: 1.45; }

    /* Wallet apps */
    .walletGrid{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .walletCard{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(255,255,255,.04), rgba(0,0,0,.18));
      padding: 12px;
      box-shadow: 0 12px 30px rgba(0,0,0,.26);
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), box-shadow var(--dur2) var(--ease), filter var(--dur2) var(--ease);
      max-height: 340px;
      overflow: hidden;
    }
    .walletCard .walletAddrs{
      max-height: 240px;
      overflow: auto;
    }
    .walletCard:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.20); box-shadow: 0 16px 40px rgba(0,0,0,.32); filter: saturate(1.02); }
    .walletTop{
      display:flex;
      align-items:center;
      gap:10px;
      justify-content:space-between;
    }
    .walletIcon{
      width: 36px;
      height: 36px;
      border-radius: 12px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight: 950;
      font-size: 14px;
      color: #050614;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.32), transparent 55%),
        linear-gradient(135deg, var(--brand-color, #999), rgba(0,0,0,.10));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 26px rgba(0,0,0,.26);
    }
    .walletTitle{
      margin:0;
      font-size: var(--t2);
      font-weight: 950;
      letter-spacing: .01em;
    }
    .walletNote{
      margin:6px 0 0;
      color: rgba(245,245,255,.70);
      font-size: var(--t1);
      line-height: 1.45;
    }
    .walletAddrs{
      margin-top: 10px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }
    .walletRow{
      border-radius: var(--r3);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      padding: 10px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      min-width: 0;
      transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease), box-shadow var(--dur2) var(--ease), background var(--dur2) var(--ease), opacity var(--dur) var(--ease);
      opacity: .95;
    }
    .walletRow .addrBtns{
      opacity: .86;
      transition: opacity var(--dur) var(--ease);
    }
    .walletRow:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 10px 24px rgba(0,0,0,.28);
      background: rgba(255,255,255,.06);
      opacity: 1;
    }
    .walletRow:hover .addrBtns{ opacity:1; }
    .walletLabel{
      font-size: var(--t0);
      color: rgba(245,245,255,.70);
      letter-spacing: .05em;
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    .walletRow .addrVal{
      font-family: var(--mono);
      font-size: 12.5px;
      color: rgba(245,245,255,.90);
      word-break: break-all;
      white-space: normal;
    }

    /* Accordion toggles (right column) */
    /* Left-side crypto table */
    .miniTableWrap{
      overflow:auto;
      max-height: 380px; /* ~6 rows visible before scroll */
      margin-top: 12px;
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
    }
    .miniTable{
      width:100%;
      border-collapse: separate;
      border-spacing: 0;
      min-width: 640px;
      font-size: var(--t1);
    }
    .miniTable thead th{
      text-align:left;
      padding: 10px;
      font-size: var(--t0);
      text-transform: uppercase;
      letter-spacing: .08em;
      color: rgba(245,245,255,1);
      background: rgba(0,0,0,.92);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .miniTable thead th:hover{
      background: rgba(0,0,0,1);
    }
    .miniTable tbody td{
      padding: 10px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      vertical-align: top;
    }
    .miniIcon{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width: 38px;
      height: 28px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 900;
      color: #050614;
      background: linear-gradient(135deg, var(--brand-color, #999), rgba(0,0,0,.12));
      border: 1px solid rgba(255,255,255,.16);
    }
    .miniIcon img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display:block;
    }
    .miniIconImg{
      padding: 0;
      background: transparent;
      border: 0;
    }
    .brandSvg{
      width: 30px;
      height: 26px;
      object-fit: contain;
      display:block;
    }

    /* Hideable sections (right) */
    .fold{
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      padding: 10px 12px;
      margin-top: 12px;
      transition: border-color var(--dur) var(--ease), transform var(--dur) var(--ease);
    }
    .fold:hover{ border-color: rgba(255,255,255,.18); transform: translateY(-1px); }
    .fold > summary{
      cursor: pointer;
      list-style:none;
      font-weight: 950;
      font-size: var(--t2);
      color: rgba(245,245,255,.92);
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .fold > summary::-webkit-details-marker{ display:none; }
    .fold .body{ margin-top: 10px; }

    /* Toast + modal */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(10,10,18,.86);
      box-shadow: 0 18px 55px rgba(0,0,0,.55);
      color: rgba(245,245,255,.92);
      font-size: var(--t1);
      opacity: 0;
      pointer-events:none;
      transition: opacity var(--dur2) var(--ease), transform var(--dur2) var(--ease);
      z-index: 99;
      min-width: min(520px, calc(100vw - 24px));
      text-align:center;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-2px); }

    dialog{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(10,10,18,.92);
      box-shadow: var(--shadow);
      color: var(--text);
      width: min(760px, calc(100vw - 24px));
      animation: popIn 180ms var(--ease);
    }
    dialog::backdrop{
      background: rgba(0,0,0,.58);
      backdrop-filter: blur(6px);
      animation: fadeIn 160ms var(--ease);
    }
    .modalHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .modalHead h3{
      margin:0;
      font-size: var(--t3);
    }
    .modalBody{ margin-top: 12px; }
    .modalGrid{
      display:grid;
      grid-template-columns: 260px 1fr;
      gap: 12px;
      align-items:start;
    }
    @media (max-width: 720px){
      .modalGrid{ grid-template-columns: 1fr; }
    }
    .qrImg{
      width: 260px;
      height: 260px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
    }
    @media (max-width: 720px){
      .qrImg{ width:100%; height:auto; aspect-ratio: 1/1; }
    }
    .modalMono{
      font-family: var(--mono);
      font-size: 12.5px;
      color: rgba(245,245,255,.90);
      word-break: break-all;
    }

    footer{
      margin-top: 18px;
      color: rgba(245,245,255,.55);
      font-size: var(--t0);
      line-height: 1.5;
    }
    @keyframes fadeIn{ from{ opacity:0; } to{ opacity:1; } }
    @keyframes popIn{ from{ opacity:0; transform: scale(.98); } to{ opacity:1; transform: scale(1); } }
    @keyframes hue{
      0%{ filter: blur(12px) hue-rotate(0deg); }
      100%{ filter: blur(12px) hue-rotate(360deg); }
    }
    @keyframes pulseBar{
      0%{ opacity:.9; transform: scaleY(.9); }
      100%{ opacity:.3; transform: scaleY(1); }
    }
    @keyframes fadeUp{ from{ opacity:0; transform: translateY(8px); } to{ opacity:1; transform: none; } }
    @keyframes ctaIn{ from{ opacity:0; transform: translateY(8px); } to{ opacity:1; transform: none; } }
    .footerGrid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 980px){
      .footerGrid{ grid-template-columns: 1fr; }
    }
    .link{
      text-decoration: underline;
      text-decoration-color: rgba(245,245,255,.22);
      text-underline-offset: 3px;
    }

    /* Tiny Arch easter-egg banner (hidden by default) */
    .archBanner{
      display:none;
      margin-top: 12px;
      padding: 12px;
      border-radius: var(--r2);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
    }
    .archBanner.on{ display:block; }
    .archBanner strong{ font-weight: 950; }

        /* =========================
       RESPONSIVENESS HOTFIX
       - Make mainGrid collapse earlier
       - Make offerings wrap based on available width (auto-fit)
       - Prevent grid overflow issues (min-width:0)
       ========================= */
    
    .mainGrid{
      align-items: start;
      /* Keep right sidebar from growing too wide on mid widths */
      grid-template-columns: minmax(0, 1fr) minmax(320px, 420px);
    }
    
    /* Critical: allow grid children to shrink without overflowing */
    .mainGrid > *{ min-width: 0; }
    
    /* Collapse to single column sooner (your 980px breakpoint is too late) */
    @media (max-width: 1180px){
      .mainGrid{ grid-template-columns: 1fr; }
    }
    
    /* Offerings should be responsive to column width, not viewport width */
    .offerGrid{
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }
    
    /* Also improve the hero two-panel area (same issue) */
    .heroGrid{
      grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
    }
    
    /* Optional: prevent the right sidebar from feeling “stuck wide” at mid widths */
    @media (max-width: 1320px){
      .mainGrid{
        grid-template-columns: minmax(0, 1fr) minmax(320px, 380px);
      }
    }
    .mainGrid{ align-items:start; grid-template-columns:minmax(0,1fr) minmax(320px,420px); }
    
    .mainGrid > *{ min-width:0; }
    
    @media (max-width: 1180px){
      .mainGrid{ grid-template-columns: 1fr; }
    }
    
    .offerGrid{ grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .heroGrid{ grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); }

  </style>
</head>

<body>
  <header>
    <div class="top">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="brandText">
          <p class="brandTitle" id="brandTitle">Donate • 0xElectron + 0xLEANux</p>
          <p class="brandSub" id="brandSub">One hub • two recipients • fixed RGB background</p>
        </div>
      </div>

      <div class="topRight">
        <div class="seg" role="tablist" aria-label="Select recipient">
          <button id="tabDev" class="active" role="tab" aria-selected="true" type="button">
            @0xElectron <span class="badge">DEV</span>
          </button>
          <button id="tabOrg" role="tab" aria-selected="false" type="button">
            @0xLEANux <span class="badge">ORG</span>
          </button>
        </div>

        <span class="pill">Selected <code id="selHandle">@0xElectron</code></span>
        <a class="btn btnSm btnGhost" id="btnProfile" target="_blank" rel="noopener" data-utm="top-profile">Profile</a>
        <a class="btn btnSm btnPrimary" id="btnSponsor" target="_blank" rel="noopener" data-utm="top-sponsor">Sponsor</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="rgb panel hero" aria-label="Donation hero">
      <h1 id="heroTitle">Support @0xElectron</h1>
      <p id="heroCopy">
        Unified donation hub for @0xElectron (DEV) and @0xLEANux (ORG). Choose the recipient above, then pick Sponsors/Card/PayPal/Crypto.
        Background stays fixed. Only the content scrolls.
      </p>

      <div class="chips">
        <span class="chip good">Recurring support</span>
        <span class="chip warn">One-time donations</span>
        <span class="chip">Crypto (BTC/ETH)</span>
        <span class="chip">Arch-friendly</span>
      </div>

      <div class="heroGrid">
        <div class="subPanel">
          <div class="ctaRow">
            <a class="btn btnPrimary" id="ctaSponsors" target="_blank" rel="noopener" data-utm="cta-sponsors">GitHub Sponsors</a>
            <a class="btn" id="ctaCard" target="_blank" rel="noopener" data-utm="cta-card">Donate by Card</a>
            <a class="btn" id="ctaPayPal" target="_blank" rel="noopener" data-utm="cta-paypal">Donate via PayPal</a>
            <button class="btn" id="ctaCrypto" type="button">Show Crypto (QR)</button>
          </div>

          <div class="kpiGrid" aria-label="Donation summary">
            <div class="kpi">
              <div class="label">Best recurring</div>
              <div class="value">Sponsors</div>
              <div class="desc">Sustains maintenance and roadmap work.</div>
            </div>
            <div class="kpi">
              <div class="label">Best one-time</div>
              <div class="value">Card / PayPal</div>
              <div class="desc">Fast checkout for most supporters.</div>
            </div>
            <div class="kpi">
              <div class="label">Arch mode</div>
              <div class="value">Enabled</div>
              <div class="desc">Includes pacman/AUR cheatsheet + tips.</div>
            </div>
          </div>

          <div class="metaStrip" aria-label="Recipient quick facts">
            <div class="metaItem">
              <div class="metaLabel">Recommended rail</div>
              <div class="metaValue" id="metaRec">Sponsors</div>
              <div class="metaNote" id="metaRecNote">Best for recurring support.</div>
            </div>
            <div class="metaItem">
              <div class="metaLabel">Configured methods</div>
              <div class="metaValue" id="metaConfigured">--</div>
              <div class="metaNote">Rails live for this recipient.</div>
            </div>
            <div class="metaItem">
              <div class="metaLabel">Deep link</div>
              <div class="metaValue" id="metaDeep">?to=dev</div>
              <div class="metaNote">Share directly to this tab.</div>
            </div>
          </div>

          <div class="impactStrip" aria-label="Why your donation matters">
            <div class="impactCard">
              <p class="impactTitle">Ship more fixes</p>
              <p class="impactText">Each recurring gift buys maintainer time for triage, security patches, and roadmap work.</p>
            </div>
            <div class="impactCard">
              <p class="impactTitle">Keep things reliable</p>
              <p class="impactText">Funds CI minutes, bandwidth, and backups so releases stay stable for everyone.</p>
            </div>
            <div class="impactCard">
              <p class="impactTitle">Trust the source</p>
              <p class="impactText">Addresses are verified on-page and in git history; no third-party forms are required.</p>
            </div>
          </div>

          <div class="archBanner" id="archBanner">
            <strong>Arch note:</strong> press the <span class="mono">A</span> key again to hide this banner.
            Also yes, we know. “I use Arch btw.”
          </div>

          <p class="fineprint">
            Deep links: <span class="mono">?to=dev</span> or <span class="mono">?to=org</span>.
            Put this page in GitHub <span class="mono">FUNDING.yml</span> as a custom URL for repos.
          </p>
        </div>

        <div class="subPanel">
          <p class="pMuted">
            Quick non-monetary support (still very valuable):
          </p>
          <div style="margin-top:12px; display:flex; flex-wrap:wrap; gap:10px;">
            <button class="btn btnSm btnGhost" type="button" data-action="star">Star repos</button>
            <button class="btn btnSm btnGhost" type="button" data-action="issue">Report bugs</button>
            <button class="btn btnSm btnGhost" type="button" data-action="pr">Send a PR</button>
            <button class="btn btnSm btnGhost" type="button" data-action="share">Share link</button>
            <button class="btn btnSm btnGhost" type="button" data-action="packaging">Package / AUR help</button>
          </div>

          <div style="height:12px;"></div>

          <p class="pMuted">
            Arch-based distributions: Arch itself, plus Arch-based setups in the wild (e.g., EndeavourOS / Manjaro / Garuda / ArcoLinux).
            Regardless of preference, the “real boss” is your maintenance pipeline: updates, reproducible configs, and good docs.
          </p>

          <p class="fineprint">
            If you want your config to survive a rolling release: one part pacman; three parts backup; a dash of patience.
          </p>
        </div>
      </div>
    </section>

    <div class="mainGrid">
      <section class="rgb panel" aria-label="Offerings and methods">
        <h2 class="h2">Suggested offerings (explicit DEV + ORG buttons)</h2>
        <p class="pMuted">
          Each tier shows buttons for both recipients. Configure different links per recipient/method in CFG.
        </p>

        <div class="currencySwitch" aria-label="Select display currency">
          <span class="fineprint" style="margin:0;">Display currency:</span>
          <button class="filterBtn active" type="button" data-currency="usd">USD $</button>
          <button class="filterBtn" type="button" data-currency="eur">EUR €</button>
          <button class="filterBtn" type="button" data-currency="gbp">GBP £</button>
        </div>

        <div class="offerGrid" id="offers"></div>

        <div style="height:16px;"></div>

        <h2 class="h2">All donation methods (selected recipient)</h2>
        <p class="pMuted">
          Search, filter, and show only configured methods. Desktop = matrix; mobile = cards.
        </p>

        <div class="filters">
          <label class="search" aria-label="Search donation methods">
            <span class="srOnly">Search</span>
            <input id="search" type="text" placeholder="Search: sponsors, paypal, stripe, kofi, open collective, crypto, wise..." />
          </label>

          <label class="toggle">
            <input id="onlyConfigured" type="checkbox" checked />
            Show only configured
          </label>

          <div class="filterTabs" aria-label="Filter by donation cadence">
            <button class="filterBtn active" type="button" data-filter-type="all">All</button>
            <button class="filterBtn" type="button" data-filter-type="recurring">Monthly</button>
            <button class="filterBtn" type="button" data-filter-type="one-time">One-time</button>
          </div>
        </div>

        <p class="fineprint" style="margin-top:8px;">Donate anonymously: leave your name blank on Card/PayPal/Sponsors, or use crypto (address-only).</p>

        <div class="tableWrap" role="region" aria-label="Donation methods table">
          <table>
            <thead>
              <tr>
                <th style="width: 18%;">Method</th>
                <th style="width: 12%;">Type</th>
                <th style="width: 16%;">GitHub Sponsor menu</th>
                <th style="width: 34%;">Notes</th>
                <th style="width: 12%;">Status</th>
                <th style="width: 8%;">Action</th>
              </tr>
            </thead>
            <tbody id="methodsBody"></tbody>
          </table>
        </div>

        <div class="methodCards" id="methodCards" aria-label="Donation methods (mobile)"></div>

        <div style="height:16px;"></div>

        <h2 class="h2">MetaMask addresses</h2>
        <p class="pMuted">Chain-specific MetaMask addresses (per recipient).</p>
        <div class="miniTableWrap" aria-label="MetaMask wallet table">
          <table class="miniTable">
            <thead>
              <tr>
                <th style="width:14%; text-align:center;">Icon</th>
                <th style="width:26%;">Chain</th>
                <th style="width:40%; text-align:center;">Address</th>
                <th style="width:20%; text-align:center;">Action</th>
              </tr>
            </thead>
            <tbody id="metamaskTableBody"></tbody>
          </table>
        </div>

        <div style="height:12px;"></div>

        <h2 class="h2">Atomic Wallet addresses</h2>
        <p class="pMuted">Chain-specific Atomic Wallet addresses (per recipient).</p>
        <div class="miniTableWrap" aria-label="Atomic Wallet table">
          <table class="miniTable">
            <thead>
              <tr>
                <th style="width:14%; text-align:center;">Icon</th>
                <th style="width:26%;">Chain</th>
                <th style="width:40%; text-align:center;">Address</th>
                <th style="width:20%; text-align:center;">Action</th>
              </tr>
            </thead>
            <tbody id="atomicTableBody"></tbody>
          </table>
        </div>

        <div style="height:16px;"></div>

        <h2 class="h2">Supporter wall (manual / placeholder)</h2>
        <p class="pMuted">
          GitHub Pages is static, so this is intentionally a “manual wall.” Add names if supporters opt in.
        </p>

        <div class="wall">
          <div class="pMuted">
            Want to be listed? Donate publicly (Sponsors) or add a note “OK to list my name,” then I can add you here.
          </div>

          <div class="wallGrid" id="wallGrid">
            <div class="wallCard">
              <div class="wallName">Supporter Slot</div>
              <div class="wallNote">Add a name here (optional). Example: “Thanks for keeping the builds green.”</div>
            </div>
            <div class="wallCard">
              <div class="wallName">Supporter Slot</div>
              <div class="wallNote">Add a name here (optional). Example: “Docs enjoyer; fixes my future self.”</div>
            </div>
            <div class="wallCard">
              <div class="wallName">Supporter Slot</div>
              <div class="wallNote">Add a name here (optional). Example: “AUR helper; pacman approves.”</div>
            </div>
          </div>
        </div>

        <footer class="fineprint">
          GitHub supports specific platforms plus up to 4 custom URLs. Use custom URLs for Stripe/PayPal/crypto hub flows.
        </footer>
      </section>

      <aside class="rgb panel" aria-label="Crypto and Arch Corner">
        <details class="fold" open>
          <summary>Crypto for selected recipient</summary>
          <div class="body">
            <p class="pMuted">Copy addresses or open a QR. Addresses are per recipient (DEV/ORG).</p>
            <div class="addrBox" id="cryptoBox"></div>
          </div>
        </details>

        <details class="fold" open>
          <summary>Wallet apps (MetaMask & Atomic Wallet)</summary>
          <div class="body">
            <p class="pMuted">Use the wallets you already trust. MetaMask reads ETH/L2s; Atomic covers BTC/ETH/alt-chains. Full lists also appear in the tables on the left.</p>
            <div class="walletGrid" id="walletGrid"></div>
          </div>
        </details>

        <details class="fold">
          <summary>Verify this page</summary>
          <div class="body">
            <div class="verifyBox" aria-label="Donation verification">
              <p class="verifyTitle">Verify this page</p>
              <p class="verifyNote">Only trust addresses shown here and in the signed git history of this repo.</p>

              <div class="verifyRow" id="verifyBTC"></div>
              <div class="verifyRow" id="verifyETH"></div>

              <p class="verifyFine">Optional: publish a PGP-signed DONATION_ADDRESSES.txt.asc; donors can also cross-check commit history before sending.</p>
            </div>
          </div>
        </details>

        <details class="fold">
          <summary>Arch Corner</summary>
          <div class="body">
            <div class="archGrid">
              <div class="archTip">
                <div class="cmdTop">
                  <div>
                    <p class="archTipTitle">Random Arch tip</p>
                    <p class="archTipText" id="archTipText">—</p>
                  </div>
                  <div style="display:flex; gap:8px; flex-wrap:wrap;">
                    <button class="btn btnSm" type="button" id="btnNewTip">New tip</button>
                    <button class="btn btnSm btnGhost" type="button" id="btnArchMode">“ArchIt!”</button>
                  </div>
                </div>
              </div>

              <div class="archTip">
                <p class="archTipTitle">Pacman & AUR cheatsheet (copyable)</p>
                <p class="archTipText">
                  If your donation funds one thing, let it be: fewer broken upgrades and more calm.
                </p>

                <div class="cmdList" id="cmdList"></div>
              </div>

              <div class="archTip">
                <p class="archTipTitle">Arch-based distro reality check</p>
                <p class="archTipText">
                  Arch itself gives you maximum control and responsibility. Arch-based distros often smooth the edges.
                  Neither is “better”; it’s about how much you enjoy tinkering vs shipping.
                </p>
              </div>
            </div>
          </div>
        </details>

        <details class="fold" open>
          <summary>FAQ</summary>
          <div class="body">
            <details open>
              <summary>Which method is best?</summary>
              <p>
                Sponsors is best for long-term work. One-time: Card (Stripe) or PayPal is simplest. Crypto works if you prefer it.
              </p>
            </details>
            <details open>
              <summary>Can I donate to both DEV and ORG?</summary>
              <p>
                Yes. Use the offerings section (DEV and ORG buttons side-by-side), or switch the recipient in the top bar.
              </p>
            </details>
            <details open>
              <summary>Why does diffusion of methods matter?</summary>
              <p>
                Different supporters prefer different rails. The goal is raising “conversion”: less friction for donors, more stability for maintainers.
              </p>
            </details>
          </div>
        </details>

        <footer class="fineprint">
          Security: never publish private keys. Only publish receiving addresses. On Arch: backups are not optional; they are the main feature.
        </footer>
      </aside>
    </div>

    <footer class="rgb panel" aria-label="Footer">
      <div class="footerGrid">
        <div class="subPanel">
          <div style="font-weight:950; font-size:var(--t3);">Connect GitHub Sponsor button</div>
          <p class="pMuted" style="margin-top:8px;">
            Put this hub in <span class="mono">custom:</span> in <span class="mono">.github/FUNDING.yml</span>.
          </p>
          <p class="fineprint">
            Recommended: use two custom links so donors land on the right tab: <span class="mono">?to=dev</span> and <span class="mono">?to=org</span>.
          </p>
        </div>

        <div class="subPanel">
          <div style="font-weight:950; font-size:var(--t3);">Profiles</div>
          <p class="pMuted" style="margin-top:8px;">
            Developer: <a class="link" href="https://github.com/0xElectron" target="_blank" rel="noopener">github.com/0xElectron</a><br/>
            Organization: <a class="link" href="https://github.com/0xLEANux" target="_blank" rel="noopener">github.com/0xLEANux</a>
          </p>
          <p class="fineprint">
            Deep links: <span class="mono">/donate/?to=dev</span> or <span class="mono">/donate/?to=org</span>.
          </p>
        </div>
      </div>
    </footer>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <dialog id="qrModal">
    <div class="modalHead">
      <h3 id="qrTitle">QR</h3>
      <button class="btn btnSm btnGhost" id="qrClose" type="button">Close</button>
    </div>
    <div class="modalBody">
      <div class="modalGrid">
        <img id="qrImg" class="qrImg" alt="QR code" />
        <div>
          <div class="pMuted" style="margin:0;">Data</div>
          <div class="modalMono" id="qrData" style="margin-top:8px;"></div>
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="btn btnSm" id="qrCopy" type="button">Copy data</button>
            <button class="btn btnSm btnGhost" id="qrCopyAddr" type="button">Copy address</button>
          </div>
          <p class="fineprint" style="margin-top:12px;">
            QR renders as an image URL (no third-party JS). For fully offline, host your own PNGs and replace the image source.
          </p>
        </div>
      </div>
    </div>
  </dialog>

  <script src="/donate/qrcode.js"></script>
  <script>
    /* =========================
       CONFIG (LOADED FROM config.json)
       ========================= */
    const BG_STYLES = [
      `radial-gradient(1200px 580px at 14% 10%, rgba(183,107,255,.10), transparent 60%),
       radial-gradient(1000px 560px at 90% 0%, rgba(0,229,255,.065), transparent 60%),
       radial-gradient(980px 560px at 40% 120%, rgba(255,107,214,.04), transparent 60%),
       radial-gradient(780px 520px at 78% 120%, rgba(124,255,158,.03), transparent 62%),
       linear-gradient(180deg, var(--bg2), var(--bg0))`,
      `radial-gradient(1200px 620px at 20% 8%, rgba(0,229,255,.08), transparent 60%),
       radial-gradient(980px 600px at 80% 6%, rgba(183,107,255,.09), transparent 60%),
       radial-gradient(900px 520px at 40% 110%, rgba(124,255,158,.03), transparent 60%),
       linear-gradient(180deg, rgba(6,8,18,.90), var(--bg0))`,
      `radial-gradient(1100px 540px at 16% 12%, rgba(255,107,214,.08), transparent 60%),
       radial-gradient(960px 520px at 88% 12%, rgba(0,229,255,.06), transparent 60%),
       radial-gradient(860px 520px at 60% 120%, rgba(183,107,255,.05), transparent 60%),
       linear-gradient(180deg, rgba(4,5,14,.94), var(--bg0))`
    ];
    const DEFAULT_CFG = {
      pageTitle: "Donate • 0xElectron + 0xLEANux",
      hubCanonical: "https://0xElectron.github.io/donate/",
      recipients: {
        dev: {
          id: "dev",
          label: "@0xElectron",
          kind: "Developer",
          profile: "https://github.com/0xElectron",
          sponsors: "https://github.com/sponsors/0xElectron",
          card: "YOUR_STRIPE_PAYMENT_LINK_DEV",
          paypal: "YOUR_PAYPAL_LINK_DEV",
          openCollective: "",
          koFi: "https://ko-fi.com/0xLEANux",
          buyMeACoffee: "https://www.buymeacoffee.com/0xLEANux",
          patreon: "https://www.patreon.com/c/0xLEANux?utm_medium=unknown&utm_source=join_link&utm_campaign=creatorshare_creator&utm_content=copyLink",
          liberapay: "",
          polar: "",
          thanksDev: "",
          issueHunt: "",
          tidelift: "",
          communityBridge: "",
          wise: "",
          revolut: "",
          bankTransfer: "",
          crypto: { btc: "YOUR_BTC_ADDRESS_DEV", eth: "YOUR_ETH_ADDRESS_DEV" }
        },
        org: {
          id: "org",
          label: "@0xLEANux",
          kind: "Organization",
          profile: "https://github.com/0xLEANux",
          sponsors: "https://github.com/sponsors/0xLEANux",
          card: "YOUR_STRIPE_PAYMENT_LINK_ORG",
          paypal: "YOUR_PAYPAL_LINK_ORG",
          openCollective: "",
          koFi: "https://ko-fi.com/0xLEANux",
          buyMeACoffee: "https://www.buymeacoffee.com/0xLEANux",
          patreon: "https://www.patreon.com/c/0xLEANux?utm_medium=unknown&utm_source=join_link&utm_campaign=creatorshare_creator&utm_content=copyLink",
          liberapay: "",
          polar: "",
          thanksDev: "",
          issueHunt: "",
          tidelift: "",
          communityBridge: "",
          wise: "",
          revolut: "",
          bankTransfer: "",
          crypto: { btc: "YOUR_BTC_ADDRESS_ORG", eth: "YOUR_ETH_ADDRESS_ORG" }
        }
      },
      offerings: [
        { name:"Coffee",    price:"$5",  note:"Quick thank-you for a useful project, release, or fix.", actions:["card","paypal","sponsors"] },
        { name:"Supporter", price:"$15", note:"Helps with maintenance, docs, packaging, CI, and small improvements.", actions:["card","paypal","sponsors","kofi","buymeacoffee"] },
        { name:"Sponsor",   price:"$50", note:"Back roadmap features, refactors, and long-term support work.", actions:["sponsors","card","paypal","opencollective","patreon","polar"] }
      ]
    };
    let CFG = DEFAULT_CFG;

    /* =========================
       ARCH FUN CONTENT
       ========================= */
    const ARCH_TIPS = [
      "If you update daily, you debug daily. If you update monthly, you debug monthly. Choose your poison responsibly.",
      "The Arch Wiki is not documentation; it is a lifestyle decision.",
      "A clean pacman cache feels like deleting 200 browser tabs you swore you still needed.",
      "If your system breaks after an upgrade, you didn’t break it — you just discovered new features.",
      "In rolling releases, stability is a habit: backups, snapshots, and reading news before -Syu.",
      "The unofficial Arch motto: minimalism with maximum knobs.",
      "AUR pro-tip: read PKGBUILDs like you read shell scripts you didn’t write: carefully.",
      "If your dotfiles survive a reinstall, you have achieved enlightenment (or you use git).",
      "Remember: pacman is fast. Your decisions are what’s slow.",
      "It’s not 'I use Arch btw'—it’s 'I maintain Arch btw'."
    ];

    const PACMAN_CMDS = [
      { name: "System update", desc: "Sync repos and upgrade everything.", cmd: "sudo pacman -Syu" },
      { name: "Search packages", desc: "Search repo packages by keyword.", cmd: "pacman -Ss <term>" },
      { name: "Installed packages", desc: "List explicitly installed packages.", cmd: "pacman -Qe" },
      { name: "Orphans (safe cleanup)", desc: "List orphaned deps (review before removing).", cmd: "pacman -Qdt" },
      { name: "Remove orphans", desc: "Remove orphan deps (carefully).", cmd: "sudo pacman -Rns $(pacman -Qdtq)" },
      { name: "Package info", desc: "Show detailed info about a package.", cmd: "pacman -Qi <pkg>" },
      { name: "Who depends on X", desc: "View dependency tree for a package.", cmd: "pactree -r <pkg>" },
      { name: "Fast file ownership", desc: "Find which package owns a file.", cmd: "pacman -Qo /path/to/file" },
      { name: "AUR helper update (example)", desc: "If you use yay; adapt to your helper.", cmd: "yay -Syu" },
      { name: "Mirrors refresh (example)", desc: "Use reflector if installed (adjust country).", cmd: "sudo reflector --country NL,DE --latest 20 --sort rate --save /etc/pacman.d/mirrorlist" }
    ];

    /* =========================
       HELPERS
       ========================= */
    const toast = document.getElementById("toast");
    const qrModal = document.getElementById("qrModal");
    const qrImg = document.getElementById("qrImg");
    const qrTitle = document.getElementById("qrTitle");
    const qrData = document.getElementById("qrData");
    const qrCopy = document.getElementById("qrCopy");
    const qrCopyAddr = document.getElementById("qrCopyAddr");

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toast.classList.remove("show"), 1500);
    }

    function isConfigured(v){
      if(Array.isArray(v)) return v.some(isConfigured);
      return typeof v === "string" && v.trim() && !v.includes("YOUR_");
    }

    function mergeConfig(base, incoming){
      return {
        ...base,
        ...incoming,
        recipients: {
          dev: {
            ...base.recipients.dev,
            ...(incoming.recipients?.dev || {}),
            crypto: { ...base.recipients.dev.crypto, ...(incoming.recipients?.dev?.crypto || {}) }
          },
          org: {
            ...base.recipients.org,
            ...(incoming.recipients?.org || {}),
            crypto: { ...base.recipients.org.crypto, ...(incoming.recipients?.org?.crypto || {}) }
          }
        },
        offerings: Array.isArray(incoming.offerings) && incoming.offerings.length ? incoming.offerings : base.offerings
      };
    }

    function recommendedRail(r){
      if(isConfigured(r.sponsors)) return { label:"Sponsors", note:"Recurring; highest impact over time." };
      if(isConfigured(r.card)) return { label:"Card", note:"Fast one-time checkout." };
      if(isConfigured(r.paypal)) return { label:"PayPal", note:"Common one-time option." };
      if(isConfigured(r.crypto?.btc) || isConfigured(r.crypto?.eth)) return { label:"Crypto", note:"Use QR or copy address." };
      return { label:"Configure links", note:"Set URLs in config.json" };
    }

    function chainLabel(chain){
      const map = {
        btc:"Bitcoin",
        eth:"Ethereum",
        eth_arb:"Arbitrum",
        eth_linea:"Linea",
        sol:"Solana",
        arbitrum:"Arbitrum",
        base:"Base",
        linea:"Linea",
        polygon:"Polygon",
        op:"OP",
        bnb:"BNB Chain",
        sei:"Sei",
        glmr:"Moonbeam",
        dogs:"DOGS",
        justachilguy:"Just a Chil Guy",
        btt:"BitTorrent",
        ada:"Cardano",
        shibarium:"Shibarium",
        shib:"Shiba Inu",
        zec:"ZCash",
        hex:"HEX",
        nexo:"NEXO",
        chz:"Chiliz",
        chaingpt:"ChainGPT",
        xaut:"Tether Gold"
      };
      return map[chain.toLowerCase()] || chain.toUpperCase();
    }

    function svgBadge(color, label){
      const fill = (color || "#666").replace("#","%23");
      const text = (label || "").slice(0,4);
      return `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='${fill}'/><text x='50%' y='55%' text-anchor='middle' font-family='Arial Black,Arial,sans-serif' font-size='24' fill='%23fff' font-weight='700'>${text}</text></svg>`;
    }

    const BRAND_SVG = {
      btc: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23f7931a'/><path fill='%23fff' d='M36 18h2c3 0 5 2 5 5 0 2-1 3-2 4 3 1 5 3 5 6 0 4-3 7-8 7h-3v6h-4v-6h-3v-4h3v-5h-3v-4h3v-5h4v5h1c2 0 3-1 3-2 0-1-1-2-2-2h-2v-5z'/></svg>",

      eth: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%232b2d3a'/><path fill='%23627eea' d='M32 6 16 32l16 10 16-10z'/><path fill='%239ba3f0' d='M16 34 32 58l16-24-16 10z'/></svg>",

      sol: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23071620'/><linearGradient id='g' x1='0%' y1='0%' x2='100%' y2='0%'><stop offset='0%' stop-color='%2314f195'/><stop offset='100%' stop-color='%238957ff'/></linearGradient><rect x='14' y='14' width='36' height='8' rx='4' fill='url(%23g)'/><rect x='14' y='28' width='36' height='8' rx='4' fill='url(%23g)' opacity='.8'/><rect x='14' y='42' width='36' height='8' rx='4' fill='url(%23g)' opacity='.65'/></svg>",

      arbitrum: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%2328a0f0'/><path fill='%23fff' d='M22 18h20l8 28h-6l-5-18-5 18h-6l-6-20z'/></svg>",

      base: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%230052ff'/><circle cx='32' cy='32' r='16' fill='%23fff'/><circle cx='32' cy='32' r='8' fill='%230052ff'/></svg>",

      linea: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%232b2b2b'/><path fill='%23fff' d='M22 18h8v28h22v8H22z'/></svg>",

      polygon: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%238247e5'/><path fill='%23fff' d='M22 26 32 20l10 6v12l-10 6-10-6z'/></svg>",

      op: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23ff0420'/><path fill='%23fff' d='M18 30a10 10 0 0 1 10-10h8a10 10 0 0 1 0 20h-8a10 10 0 0 1-10-10z'/></svg>",

      bnb: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23f3ba2f'/><path fill='%23050f19' d='M32 10 22 20l4 4 6-6 6 6 4-4-10-10zm0 12-6 6 6 6 6-6-6-6zm-10 10-4 4 6 6 4-4-6-6zm20 0-6 6 4 4 6-6-4-4zm-10 10-6 6 6 6 6-6-6-6z'/></svg>",

      sei: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23ff5b5b'/><circle cx='32' cy='32' r='18' fill='none' stroke='%23fff' stroke-width='4'/><path d='M22 28c4-4 16-4 20 0' stroke='%23fff' stroke-width='4' fill='none' stroke-linecap='round'/><path d='M22 36c4-4 16-4 20 0' stroke='%23fff' stroke-width='4' fill='none' stroke-linecap='round'/></svg>",

      glmr: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' viewBox='0 0 24 24'><path fill='%2353CBC9' d='M8.351 9.957a5.546 5.546 0 0 1 5.595-5.497 5.545 5.545 0 0 1 5.594 5.497.34.34 0 0 1-.34.34H8.691a.34.34 0 0 1-.34-.34'/><path fill='%23CB1F7A' d='M6.892 11.756c0-.266.18-.485.404-.485H20.11c.224 0 .403.219.403.485 0 .268-.18.487-.403.487H7.296c-.224 0-.404-.219-.404-.487m-2.433 1.46c0-.268.185-.486.409-.486h9.399c.224 0 .408.218.408.486s-.184.487-.408.487h-9.4c-.223 0-.408-.219-.408-.487m2.841.973c-.223 0-.408.219-.408.487s.185.486.408.486h11.346c.223 0 .408-.218.408-.486s-.185-.487-.408-.487zm-2.354 1.945c0-.266.19-.485.419-.485h4.514c.229 0 .418.219.418.486s-.19.488-.418.488H5.365c-.23 0-.419-.22-.419-.489m8.178.974c-.22 0-.394.218-.394.486s.174.487.393.487h5.542c.22 0 .394-.219.394-.487 0-.267-.175-.486-.394-.486h-5.546zm-3.8 1.946c0-.268.175-.487.394-.487h5.542c.219 0 .394.22.394.487 0 .268-.175.486-.394.486H9.714c-.22 0-.394-.218-.394-.486zm1.873-3.405c-.228 0-.413.219-.413.486s.185.488.413.488h9.39c.228 0 .413-.22.413-.489 0-.266-.185-.485-.413-.485zm-5.764-3.894a.487.487 0 1 1 .972-.047.487.487 0 0 1-.972.047m-1.947.973a.487.487 0 1 0 0 .974.487.487 0 0 0 0-.974m1.947 1.947a.487.487 0 1 1 .972-.047.487.487 0 0 1-.972.047m-1.46.974a.486.486 0 1 0 0 .972.486.486 0 0 0 0-.972m7.297 1.945a.486.486 0 1 1 .972 0 .486.486 0 0 1-.972 0m-2.919.973a.485.485 0 0 0-.51.486.488.488 0 1 0 .51-.486'/></svg>",

      dogs: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23090b14'/><circle cx='24' cy='24' r='6' fill='%23f5a623'/><circle cx='40' cy='24' r='6' fill='%23f5a623'/><ellipse cx='32' cy='40' rx='10' ry='8' fill='%23f5a623'/></svg>",

      justachilguy: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23141928'/><path d='M30 12h8v26c0 9-5 14-14 14-4 0-7-1-10-3l3-7c2 1 4 2 6 2 5 0 7-3 7-8V12z' fill='%23e5e7ff'/></svg>",

      btt: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23ef1b2d'/><path fill='%23fff' d='M32 14a18 18 0 1 1 0 36 18 18 0 0 1 0-36zm0 4a14 14 0 1 0 0 28 14 14 0 0 0 0-28z'/></svg>",

      ada: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%230033ad'/><circle cx='32' cy='32' r='12' fill='%23fff'/><circle cx='32' cy='12' r='3' fill='%23fff'/><circle cx='32' cy='52' r='3' fill='%23fff'/></svg>",

      shib: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23f26522'/><path fill='%23fff' d='M20 32a12 12 0 0 1 24 0v10a12 12 0 0 1-24 0z'/></svg>",

      zec: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23f4b728'/><path fill='%23000' d='M22 20h20v4H26l16 20v4H22v-4h14L22 24v-4z'/></svg>",

      hex: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23ff3c7d'/><polygon points='32,10 48,20 48,44 32,54 16,44 16,20' fill='%23fff'/></svg>",

      nexo: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%232663ff'/><path fill='%23fff' d='M20 18h8l16 14v14h-8L20 32z'/></svg>",

      chz: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23e3001b'/><path d='M18 18h28L32 46 18 18zm14 0v28' stroke='%23fff' stroke-width='4' fill='none' stroke-linecap='round' stroke-linejoin='round'/></svg>",

      chaingpt: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%231f6feb'/><rect x='16' y='24' width='24' height='16' rx='8' fill='none' stroke='%23fff' stroke-width='4'/><rect x='24' y='24' width='24' height='16' rx='8' fill='none' stroke='%23fff' stroke-width='4'/></svg>",

      xaut: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23d1a941'/><text x='50%' y='55%' fill='%23000' font-size='16' font-weight='bold' text-anchor='middle'>XAUT</text></svg>",

      metamask: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%23f6851b'/><polygon fill='%23fff' points='32,10 44,30 32,54 20,30'/></svg>",

      atomicwallet: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%231d9bf0'/><path fill='%23fff' d='M32 14l14 36h-8l-6-16-6 16h-8z'/></svg>",

      eth_arb: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%2328a0f0'/><path fill='%23fff' d='M32 6 16 32l16 10 16-10z'/></svg>",

      eth_linea: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='14' fill='%232b2b2b'/><path fill='%23fff' d='M32 6 16 32l16 10 16-10z'/></svg>"
    };


    const BRAND_SVG_REMOTE = {
      btc: ["https://cryptologos.cc/logos/bitcoin-btc-logo.svg"],
      eth: ["https://cryptologos.cc/logos/ethereum-eth-logo.svg"],
      sol: ["https://cryptologos.cc/logos/solana-sol-logo.svg"],
      arbitrum: ["https://cryptologos.cc/logos/arbitrum-arb-logo.svg"],
      base: ["https://cryptologos.cc/logos/base-base-logo.svg"],
      linea: ["https://cryptologos.cc/logos/linea-linea-logo.svg", "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/linea/info/logo.png"],
      polygon: ["https://cryptologos.cc/logos/polygon-matic-logo.svg"],
      op: ["https://cryptologos.cc/logos/optimism-ethereum-op-logo.svg"],
      bnb: ["https://cryptologos.cc/logos/bnb-bnb-logo.svg"],
      sei: ["https://cryptologos.cc/logos/sei-network-sei-logo.svg", "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sei/info/logo.png"],
      glmr: ["https://cryptologos.cc/logos/moonbeam-new-glmr-logo.svg"],
      dogs: ["https://cryptologos.cc/logos/dogami-doga-logo.svg"],
      justachilguy: [],
      btt: ["https://cryptologos.cc/logos/bittorrent-new-btt-logo.svg"],
      ada: ["https://cryptologos.cc/logos/cardano-ada-logo.svg"],
      shibarium: ["https://cryptologos.cc/logos/shiba-inu-shib-logo.svg"],
      shib: ["https://cryptologos.cc/logos/shiba-inu-shib-logo.svg"],
      zec: ["https://cryptologos.cc/logos/zcash-zec-logo.svg"],
      hex: ["https://cryptologos.cc/logos/hex-hex-logo.svg"],
      nexo: ["https://cryptologos.cc/logos/nexo-nexo-logo.svg"],
      chz: ["https://cryptologos.cc/logos/chiliz-chz-logo.svg", "https://raw.githubusercontent.com/spothq/cryptocurrency-icons/master/svg/color/chz.svg"],
      chaingpt: ["https://cryptologos.cc/logos/chaingpt-gpt-logo.svg"],
      xaut: ["https://cryptologos.cc/logos/tether-gold-xaut-logo.svg"],
      eth_arb: ["https://cryptologos.cc/logos/ethereum-eth-logo.svg"],
      eth_linea: ["https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/linea/info/logo.png"],
      metamask: [],
      atomicwallet: [],
      kofi: ["https://cdn.prod.website-files.com/5c14e387dab576fe667689cf/670f5a01229bf8a18f97a3c1_favion.png"],
      bmc: ["https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg"],
      paypal: ["data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path fill='%230070ba' d='M14.06 3.713c.12-1.071-.093-1.832-.702-2.526C12.628.356 11.312 0 9.626 0H4.734a.7.7 0 0 0-.691.59L2.005 13.509a.42.42 0 0 0 .415.486h2.756l-.202 1.28a.628.628 0 0 0 .62.726H8.14c.429 0 .793-.31.862-.731l.025-.13.48-3.043.03-.164.001-.007a.35.35 0 0 1 .348-.297h.38c1.266 0 2.425-.256 3.345-.91q.57-.403.993-1.005a4.94 4.94 0 0 0 .88-2.195c.242-1.246.13-2.3-.653-2.857z'/></svg>"]
    };

    function methodTotals(r){
      const methods = buildMethods(r);
      let configured = 0;
      for(const m of methods){
        const ok = m.crypto
          ? isConfigured(r.crypto[m.crypto] || "")
          : isConfigured(m.url || "");
        if(ok) configured++;
      }
      return { configured, total: methods.length };
    }

    const CURRENCY_RATES = { usd: 1, eur: 0.92, gbp: 0.79 };
    const CURRENCY_SYMBOL = { usd: "$", eur: "€", gbp: "£" };
    const FEE_TABLE = {
      usd: { pct: 0.029, fixed: 0.30 }, // Stripe/PayPal US ballpark
      eur: { pct: 0.014, fixed: 0.25 }, // lower EU card fees
      gbp: { pct: 0.014, fixed: 0.20 }  // UK card fees
    };

    function formatCurrency(amount, cur){
      const sym = CURRENCY_SYMBOL[cur] || "$";
      const val = amount >= 10 ? amount.toFixed(0) : amount.toFixed(2);
      return `${sym}${val}`;
    }

    function grossForNet(target, cur){
      const fee = FEE_TABLE[cur] || FEE_TABLE.usd;
      const gross = (target + fee.fixed) / (1 - fee.pct);
      return gross;
    }

    async function loadConfig(){
      try{
        const res = await fetch("/donate/config.json", { cache: "no-cache" });
        if(!res.ok) throw new Error("config fetch failed");
        const data = await res.json();
        return mergeConfig(DEFAULT_CFG, data);
      }catch(err){
        console.warn("Using default config (could not load /donate/config.json)", err);
        showToast("Using default config (could not load config.json).");
        return DEFAULT_CFG;
      }
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.setAttribute("readonly","");
        ta.style.position="fixed";
        ta.style.top="-9999px";
        document.body.appendChild(ta);
        ta.select();
        let ok=false;
        try{ ok=document.execCommand("copy"); }catch(_){ ok=false; }
        document.body.removeChild(ta);
        return ok;
      }
    }

    function pulseBtn(btn){
      if(!btn) return;
      btn.classList.remove("pulse");
      void btn.offsetWidth;
      btn.classList.add("pulse");
      setTimeout(() => btn.classList.remove("pulse"), 400);
    }

    function withUTM(url, medium){
      try{
        const u = new URL(url);
        u.searchParams.set("utm_source", "donate-hub");
        u.searchParams.set("utm_medium", medium || "button");
        u.searchParams.set("utm_campaign", "github-page");
        return u.toString();
      }catch(_){
        return url;
      }
    }

    function shortAddr(v){
      if(!isConfigured(v)) return "Not configured";
      const t = v.trim();
      if(t.length <= 14) return t;
      return `${t.slice(0, 6)}…${t.slice(-6)}`;
    }

    function toList(val){
      if(Array.isArray(val)) return val.filter(x => isConfigured(x));
      return isConfigured(val) ? [val] : [];
    }

    function walletAddrs(walletKey, coin){
      const w = rec().wallets?.[walletKey]?.[coin];
      const arr = Array.isArray(w) ? w : (isConfigured(w) ? [w] : []);
      if(arr.length) return arr.filter(isConfigured);
      return toList(rec().crypto[coin]);
    }

    function getAddr(sym, idx){
      const list = toList(rec().crypto[sym] || []);
      return list[idx || 0] || "";
    }

    function generateQRDataUrl(data, size=260){
      if(typeof qrcode !== "function") return null;
      try{
        const qr = qrcode(0, "M");
        qr.addData(data);
        qr.make();
        // second arg is cell size (4px). size is handled by createDataURL internally.
        return qr.createDataURL(8, 0);
      }catch(err){
        console.warn("QR generation failed", err);
        return null;
      }
    }

    function setLink(el, url){
      if(!isConfigured(url)){
        el.setAttribute("aria-disabled","true");
        el.removeAttribute("href");
        return;
      }
      el.setAttribute("aria-disabled","false");
      el.setAttribute("href", withUTM(url, el.dataset.utm || "button"));
    }

    function qs(key){
      const u = new URL(window.location.href);
      return (u.searchParams.get(key) || "").trim().toLowerCase();
    }

    /* =========================
       STATE
       ========================= */

    /* Reveal handling */
    let revealObs;
    function tagReveal(el){
      if(!el || el.classList.contains("reveal-bound")) return;
      el.classList.add("reveal", "reveal-bound");
      if(revealObs) revealObs.observe(el);
    }

    function setupReveals(){
      if(window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches){
        document.querySelectorAll(".panel, .fold, .archTip, .offer, .methodCard, .walletCard, .addrBox, .verifyBox, .tableWrap, .miniTableWrap").forEach((el)=>el.classList.add("visible"));
        return;
      }
      revealObs = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if(entry.isIntersecting){
            entry.target.classList.add("visible");
            revealObs.unobserve(entry.target);
          }
        });
      }, { threshold: 0.14, rootMargin: "0px 0px -10%" });
      document.querySelectorAll(".panel, .fold, .archTip, .offer, .methodCard, .walletCard, .addrBox, .verifyBox, .tableWrap, .miniTableWrap").forEach(tagReveal);
    }
    const tabDev = document.getElementById("tabDev");
    const tabOrg = document.getElementById("tabOrg");
    const typeButtons = Array.from(document.querySelectorAll("[data-filter-type]"));

    const saved = localStorage.getItem("donate_to");
    const deep = qs("to");
    let selected = (deep === "org" || deep === "dev")
      ? deep
      : ((saved === "org" || saved === "dev") ? saved : "dev");
    let filterType = "all";
    let selectedCurrency = "usd";

    function rec(){ return CFG.recipients[selected]; }

    function setActiveTab(){
      tabDev.classList.toggle("active", selected === "dev");
      tabOrg.classList.toggle("active", selected === "org");
      tabDev.setAttribute("aria-selected", selected === "dev" ? "true" : "false");
      tabOrg.setAttribute("aria-selected", selected === "org" ? "true" : "false");
    }

    /* =========================
       OFFERINGS
       ========================= */
    function actionUrl(r, action){
      const a = (action || "").toLowerCase();
      switch(a){
        case "sponsors": return r.sponsors;
        case "card": return r.card;
        case "paypal": return r.paypal;
        case "opencollective": return r.openCollective;
        case "kofi": return r.koFi;
        case "buymeacoffee": return r.buyMeACoffee;
        case "patreon": return r.patreon;
        case "liberapay": return r.liberapay;
        case "polar": return r.polar;
        case "thanksdev": return r.thanksDev;
        case "issuehunt": return r.issueHunt;
        case "tidelift": return r.tidelift;
        case "communitybridge": return r.communityBridge;
        case "wise": return r.wise;
        case "revolut": return r.revolut;
        case "bank": return r.bankTransfer;
        default: return "";
      }
    }

    function actionLabel(action){
      const a = (action || "").toLowerCase();
      switch(a){
        case "sponsors": return "Sponsors";
        case "card": return "Card";
        case "paypal": return "PayPal";
        case "opencollective": return "OpenCollective";
        case "kofi": return "Ko-fi";
        case "buymeacoffee": return "BMC";
        case "patreon": return "Patreon";
        case "liberapay": return "Liberapay";
        case "polar": return "Polar";
        case "thanksdev": return "thanks.dev";
        case "issuehunt": return "IssueHunt";
        case "tidelift": return "Tidelift";
        case "communitybridge": return "LFX";
        case "wise": return "Wise";
        case "revolut": return "Revolut";
        case "bank": return "Bank";
        default: return action;
      }
    }

    function makeOfferBtn(r, action){
      const a = document.createElement("a");
      a.className = "btn btnSm btnIcon";
      a.target = "_blank";
      a.rel = "noopener";
      const actionKey = (action || "").toLowerCase();
      const brandKey = actionKey === "buymeacoffee" ? "bmc" : actionKey;
      const brand = brandTheme(brandKey);
      const iconImg = brand.remoteSvg ? `<span class="miniBrandIcon imgOnly"><img src="${brand.remoteSvg}" alt="${actionLabel(action)}" loading="lazy" decoding="async"></span>` : "";
      a.innerHTML = `${iconImg || (brand.icon ? `<span class="miniBrandIcon" style="--brand-color:${brand.color};">${brand.icon}</span>` : "")}<span>${actionLabel(action)}</span>`;
      a.dataset.utm = `offer-${brandKey}`;
      setLink(a, actionUrl(r, actionKey));
      return a;
    }

    function renderOffers(){
      const root = document.getElementById("offers");
      root.innerHTML = "";

      const dev = CFG.recipients.dev;
      const org = CFG.recipients.org;

      CFG.offerings.forEach((o, idx) => {
        const card = document.createElement("div");
        card.className = "offer";
        const tone = ["plum","cyan","mint"][idx % 3];
        card.dataset.tone = tone;

        const base = parseFloat((o.price || "").replace(/[^0-9.]/g, "")) || 0;
        const rate = CURRENCY_RATES[selectedCurrency] || 1;
        const targetNet = base * rate;
        const gross = grossForNet(targetNet, selectedCurrency);
        const main = formatCurrency(gross, selectedCurrency);
        const netText = formatCurrency(targetNet, selectedCurrency);
        const other = Object.keys(CURRENCY_RATES)
          .filter(c => c !== selectedCurrency)
          .map(c => {
            const t = base * (CURRENCY_RATES[c] || 1);
            const g = grossForNet(t, c);
            return formatCurrency(g, c);
          })
          .join(" • ");

        const head = document.createElement("div");
        head.className = "offerHead";
        head.innerHTML = `
          <div>
            <h3>${o.name}</h3>
            <div class="desc">${o.note}</div>
            <div class="fineprint" style="margin-top:8px;">≈ ${main} <span class="pMuted">(nets about ${netText} after local fees; other: ${other})</span></div>
          </div>
          <div class="price">${main}</div>
        `;

        const split = document.createElement("div");
        split.className = "splitActions";

        const devPane = document.createElement("div");
        devPane.className = "miniCard miniDev";
        devPane.innerHTML = `<div class="miniHead"><div class="who">@0xElectron</div><div class="tag">DEV</div></div><div class="miniBtns"></div>`;
        const devBtns = devPane.querySelector(".miniBtns");
        for(const a of o.actions) devBtns.appendChild(makeOfferBtn(dev, a));

        const orgPane = document.createElement("div");
        orgPane.className = "miniCard miniOrg";
        orgPane.innerHTML = `<div class="miniHead"><div class="who">@0xLEANux</div><div class="tag">ORG</div></div><div class="miniBtns"></div>`;
        const orgBtns = orgPane.querySelector(".miniBtns");
        for(const a of o.actions) orgBtns.appendChild(makeOfferBtn(org, a));

        split.appendChild(devPane);
        split.appendChild(orgPane);

        card.appendChild(head);
        card.appendChild(split);
        tagReveal(card);
        root.appendChild(card);
      });
    }

    /* =========================
       METHODS (selected recipient)
       ========================= */
    function buildMethods(r){
      return [
        { label:"GitHub Sponsors", brand:"sponsors", type:"Recurring", githubMenu:"Yes", note:"Best for ongoing support; configure tiers in Sponsors.", url:r.sponsors },

        { label:"Card (Stripe)", brand:"stripe", type:"One-time", githubMenu:"Via custom URL", note:"Recommended for Visa/Mastercard; use a Stripe Payment Link.", url:r.card },
        { label:"PayPal", brand:"paypal", type:"One-time", githubMenu:"Via custom URL", note:"PayPal.Me or a PayPal donate link.", url:r.paypal },

        { label:"Open Collective", brand:"opencollective", type:"One-time", githubMenu:"Yes", note:"Transparent OSS funding (if you use it).", url:r.openCollective },
        { label:"Ko-fi", brand:"kofi", type:"One-time", githubMenu:"Yes", note:"One-time + optional memberships.", url:r.koFi },
        { label:"Buy Me a Coffee", brand:"bmc", type:"One-time", githubMenu:"Yes", note:"Fast donor flow; common option.", url:r.buyMeACoffee },

        { label:"Patreon", brand:"patreon", type:"Recurring", githubMenu:"Yes", note:"Membership-style support (optional).", url:r.patreon },
        { label:"Liberapay", brand:"liberapay", type:"Recurring", githubMenu:"Yes", note:"Recurring donations (optional).", url:r.liberapay },
        { label:"Polar", brand:"polar", type:"Recurring", githubMenu:"Yes", note:"Polar memberships/donations (optional).", url:r.polar },

        { label:"Wise", brand:"wise", type:"One-time", githubMenu:"Via custom URL", note:"Hub-only method (not GitHub-native).", url:r.wise },
        { label:"Revolut", brand:"revolut", type:"One-time", githubMenu:"Via custom URL", note:"Hub-only method (not GitHub-native).", url:r.revolut },
        { label:"Bank transfer", brand:"bank", type:"One-time", githubMenu:"Via custom URL", note:"Hub-only method (not GitHub-native).", url:r.bankTransfer },

        { label:"Crypto (BTC)", brand:"btc", type:"One-time", githubMenu:"Via custom URL", note:"Wallet transfer (BTC only).", crypto:"btc" },
        { label:"Crypto (ETH)", brand:"eth", type:"One-time", githubMenu:"Via custom URL", note:"Wallet transfer (ETH only).", crypto:"eth" },

        { label:"MetaMask (ETH/ERC20)", brand:"metamask", type:"One-time", githubMenu:"Via custom URL", note:"Use the ETH address with MetaMask; copy or scan QR.", crypto:"eth" },
        { label:"Atomic Wallet", brand:"atomicwallet", type:"One-time", githubMenu:"Via custom URL", note:"Use BTC/ETH address in Atomic Wallet; copy or scan QR.", crypto:"btc" }
      ];
    }

    function brandTheme(key){
      const svg = BRAND_SVG[key];
      const remoteEntry = BRAND_SVG_REMOTE?.[key];
      const remote = Array.isArray(remoteEntry) ? remoteEntry.find(Boolean) : remoteEntry;
      const map = {
        sponsors:   { color:"#ea4aaa", fade:"rgba(234,74,170,.18)", icon:"❤" },
        stripe:     { color:"#635bff", fade:"rgba(99,91,255,.18)", icon:"S" },
        paypal:     { color:"#003087", fade:"rgba(0,48,135,.18)", icon:"PP" },
        opencollective:{ color:"#7f3fe4", fade:"rgba(127,63,228,.18)", icon:"OC" },
        kofi:       { color:"#29abe0", fade:"rgba(41,171,224,.18)", icon:"K" },
        bmc:        { color:"#ffdd00", fade:"rgba(255,221,0,.18)", icon:"B" },
        patreon:    { color:"#ff424d", fade:"rgba(255,66,77,.18)", icon:"P" },
        liberapay:  { color:"#f6c915", fade:"rgba(246,201,21,.18)", icon:"L" },
        polar:      { color:"#0aa0f0", fade:"rgba(10,160,240,.18)", icon:"PL" },
        wise:       { color:"#00b9ff", fade:"rgba(0,185,255,.18)", icon:"W" },
        revolut:    { color:"#0057ff", fade:"rgba(0,87,255,.18)", icon:"R" },
        bank:       { color:"#6c7a89", fade:"rgba(108,122,137,.18)", icon:"$" },
        btc:        { color:"#f7931a", fade:"rgba(247,147,26,.20)", icon:"₿" },
        eth:        { color:"#627eea", fade:"rgba(98,126,234,.20)", icon:"Ξ" },
        sol:        { color:"#14f195", fade:"rgba(20,241,149,.18)", icon:"SOL" },
        arbitrum:   { color:"#28a0f0", fade:"rgba(40,160,240,.18)", icon:"ARB" },
        base:       { color:"#0052ff", fade:"rgba(0,82,255,.18)", icon:"BASE" },
        linea:      { color:"#2b2b2b", fade:"rgba(43,43,43,.18)", icon:"LIN" },
        polygon:    { color:"#8247e5", fade:"rgba(130,71,229,.18)", icon:"POLY" },
        op:         { color:"#ff0420", fade:"rgba(255,4,32,.18)", icon:"OP" },
        bnb:        { color:"#f3ba2f", fade:"rgba(243,186,47,.18)", icon:"BNB" },
        sei:        { color:"#ff5b5b", fade:"rgba(255,91,91,.18)", icon:"SEI" },
        ada:        { color:"#0033ad", fade:"rgba(0,51,173,.18)", icon:"ADA" },
        btt:        { color:"#ef1b2d", fade:"rgba(239,27,45,.18)", icon:"BTT" },
        glmr:       { color:"#53cbc9", fade:"rgba(83,203,201,.18)", icon:"GLMR" },
        shib:       { color:"#f26522", fade:"rgba(242,101,34,.18)", icon:"SHIB" },
        shibarium:  { color:"#e64a19", fade:"rgba(230,74,25,.18)", icon:"SHIB" },
        zec:        { color:"#f4b728", fade:"rgba(244,183,40,.18)", icon:"ZEC" },
        hex:        { color:"#ff3c7d", fade:"rgba(255,60,125,.18)", icon:"HEX" },
        nexo:       { color:"#2663ff", fade:"rgba(38,99,255,.18)", icon:"NEXO" },
        chz:        { color:"#e3001b", fade:"rgba(227,0,27,.18)", icon:"CHZ" },
        chaingpt:   { color:"#1f6feb", fade:"rgba(31,111,235,.18)", icon:"GPT" },
        xaut:       { color:"#d1a941", fade:"rgba(209,169,65,.18)", icon:"XAUT" },
        dogs:       { color:"#f5a623", fade:"rgba(245,166,35,.18)", icon:"DOGS" },
        justachilguy:{ color:"#7a7f92", fade:"rgba(122,127,146,.16)", icon:"JCG" },
        eth_arb:    { color:"#28a0f0", fade:"rgba(40,160,240,.18)", icon:"ETH" },
        eth_linea:  { color:"#2b2b2b", fade:"rgba(43,43,43,.18)", icon:"ETH" },
        metamask:   { color:"#f6851b", fade:"rgba(246,133,27,.20)", icon:"MM" },
        atomicwallet:{ color:"#1d9bf0", fade:"rgba(29,155,240,.18)", icon:"AW" },
        thanksdev:  { color:"#111827", fade:"rgba(17,24,39,.16)", icon:"TD" },
        issuehunt:  { color:"#e83e8c", fade:"rgba(232,62,140,.18)", icon:"IH" }
      };
      const base = map[key] || { color:"#7a7f92", fade:"rgba(122,127,146,.16)", icon:"•" };
      return { ...base, svg: svg || base.svg, remoteSvg: remote || base.remoteSvg };
    }

    function renderMethods(){
      const body = document.getElementById("methodsBody");
      const cards = document.getElementById("methodCards");
      body.innerHTML = "";
      cards.innerHTML = "";

      const r = rec();
      const methods = buildMethods(r);

      for(const m of methods){
        const configured = m.crypto
          ? isConfigured(r.crypto[m.crypto] || "")
          : isConfigured(m.url || "");

        const status = configured
          ? `<span class="status"><span class="dot on"></span>Configured</span>`
          : `<span class="status"><span class="dot off"></span>Not set</span>`;
        const popular = false;
        const popBadge = "";
        const slug = (m.label || "").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
        const brand = brandTheme(m.brand || slug);

        // Desktop
        const tr = document.createElement("tr");
        tr.dataset.label = (m.label + " " + m.type + " " + m.note + " " + m.githubMenu).toLowerCase();
        tr.dataset.configured = configured ? "1" : "0";
        tr.dataset.type = (m.type || "").toLowerCase();
        tr.dataset.brand = m.brand || slug;
        tr.style.setProperty("--brand-color", brand.color);
        tr.style.setProperty("--brand-fade", brand.fade);
        tr.innerHTML = `
          <td>
            <div class="methodCell">
              <span class="brandIcon" style="--brand-color:${brand.color};--brand-fade:${brand.fade};">${brand.icon}</span>
              <span class="brandName">${m.label}</span>
            </div>
          </td>
          <td>${m.type}</td>
          <td>${m.githubMenu}</td>
          <td style="color: rgba(245,245,255,.64); font-size: var(--t1); line-height: 1.48;">${m.note}</td>
          <td>${status}${popBadge ? `<div style="margin-top:6px;">${popBadge}</div>` : ""}</td>
          <td></td>
        `;

        const actionTd = tr.lastElementChild;

        if(m.crypto){
          const b1 = document.createElement("button");
          b1.className = "btn btnSm";
          b1.type = "button";
          b1.textContent = "Copy";
          b1.dataset.copy = m.crypto;

          const b2 = document.createElement("button");
          b2.className = "btn btnSm btnGhost";
          b2.type = "button";
          b2.textContent = "QR";
          b2.dataset.qr = m.crypto;

          const wrap = document.createElement("div");
          wrap.style.display = "flex";
          wrap.style.gap = "8px";
          wrap.appendChild(b1);
          wrap.appendChild(b2);
          actionTd.appendChild(wrap);
        } else {
          const a = document.createElement("a");
          a.className = "btn btnSm";
          a.target = "_blank";
          a.rel = "noopener";
          a.textContent = "Open";
          a.dataset.utm = `method-${slug || "link"}`;
          setLink(a, m.url);
          actionTd.appendChild(a);
        }

        body.appendChild(tr);

        // Mobile card
        const mc = document.createElement("div");
        mc.className = "methodCard";
        mc.dataset.label = tr.dataset.label;
        mc.dataset.configured = tr.dataset.configured;
        mc.dataset.type = tr.dataset.type;
        mc.dataset.brand = m.brand || slug;
        mc.style.setProperty("--brand-color", brand.color);
        mc.style.setProperty("--brand-fade", brand.fade);

        mc.innerHTML = `
          <div class="methodTop">
            <div>
              <div class="methodCell">
                <span class="brandIcon" style="--brand-color:${brand.color};--brand-fade:${brand.fade};">${brand.icon}</span>
                <span class="brandName">${m.label}</span>
              </div>
              <div class="methodMeta">${m.type} • ${m.githubMenu}</div>
            </div>
            <div>${status}${popBadge ? `<div style="margin-top:6px;">${popBadge}</div>` : ""}</div>
          </div>
          <div class="methodNote">${m.note}</div>
          <div class="methodActions"></div>
        `;

        const actions = mc.querySelector(".methodActions");
        if(m.crypto){
          const b1 = document.createElement("button");
          b1.className = "btn btnSm";
          b1.type = "button";
          b1.textContent = "Copy";
          b1.dataset.copy = m.crypto;

          const b2 = document.createElement("button");
          b2.className = "btn btnSm btnGhost";
          b2.type = "button";
          b2.textContent = "QR";
          b2.dataset.qr = m.crypto;

          actions.appendChild(b1);
          actions.appendChild(b2);
        } else {
          const a = document.createElement("a");
          a.className = "btn btnSm";
          a.target = "_blank";
          a.rel = "noopener";
          a.textContent = "Open";
          a.dataset.utm = `method-${slug || "link"}`;
          setLink(a, m.url);
          actions.appendChild(a);
        }

        cards.appendChild(mc);
        tagReveal(mc);
      }
    }

    function applyFilters(){
      const q = document.getElementById("search").value.trim().toLowerCase();
      const only = document.getElementById("onlyConfigured").checked;

      const rows = Array.from(document.querySelectorAll("#methodsBody tr"));
      const cards = Array.from(document.querySelectorAll("#methodCards .methodCard"));

      const visible = (el) => {
        const match = !q || (el.dataset.label || "").includes(q);
        const ok = !only || el.dataset.configured === "1";
        const typeOk = filterType === "all" || (el.dataset.type || "") === filterType;
        return match && ok && typeOk;
      };

      let delay = 0;
      rows.forEach((r, idx) => {
        const show = visible(r);
        r.style.display = show ? "" : "none";
        if(show){
          r.style.animation = `fadeUp 220ms var(--ease) ${delay}ms both`;
          delay += 40;
        } else {
          r.style.animation = "";
        }
      });

      let delayCard = 0;
      cards.forEach((c) => {
        const show = visible(c);
        c.style.display = show ? "" : "none";
        if(show){
          c.style.animation = `fadeUp 220ms var(--ease) ${delayCard}ms both`;
          delayCard += 40;
        } else {
          c.style.animation = "";
        }
      });
    }

    function renderCrypto(r){
      const box = document.getElementById("cryptoBox");
      const vBtc = document.getElementById("verifyBTC");
      const vEth = document.getElementById("verifyETH");
      box.innerHTML = "";
      vBtc.innerHTML = "";
      vEth.innerHTML = "";

      const btcList = toList(r.crypto.btc);
      const ethList = toList(r.crypto.eth);

      const renderRows = (list, sym, label) => {
        if(!list.length){
          const div = document.createElement("div");
          div.className = "addrRow";
          div.innerHTML = `<div><div class="addrLabel">${label}</div><div class="addrVal">Not configured</div></div>`;
          box.appendChild(div);
          return;
        }
        const brand = brandTheme(sym.toLowerCase());
        list.forEach((addr, idx) => {
          const row = document.createElement("div");
          row.className = "addrRow";
          row.style.borderLeft = `3px solid ${brand.color || "rgba(255,255,255,.18)"}`;
          row.style.background = `linear-gradient(120deg, ${brand.fade || "rgba(255,255,255,.06)"}, rgba(255,255,255,.02))`;
          row.innerHTML = `
            <div style="min-width:0;">
              <div class="addrLabel">${label}${list.length > 1 ? ` #${idx+1}` : ""}</div>
              <div class="addrVal">${addr}</div>
            </div>
            <div class="addrBtns">
              <button class="btn btnSm" type="button" data-copy="${sym}:${idx}">Copy</button>
              <button class="btn btnSm btnGhost" type="button" data-qr="${sym}:${idx}">QR</button>
            </div>
          `;
          box.appendChild(row);
        });
      };

      renderRows(btcList, "btc", "BTC");
      renderRows(ethList, "eth", "ETH");

      const renderVerify = (el, list, label) => {
        if(!list.length){
          el.innerHTML = `
            <div style="min-width:0;">
              <div class="addrLabel">${label} (short)</div>
              <div class="shortAddr">Not configured</div>
            </div>
          `;
          return;
        }
        const addr = list[0];
        el.innerHTML = `
          <div style="min-width:0;">
            <div class="addrLabel">${label} (short)</div>
            <div class="shortAddr">${shortAddr(addr)}</div>
          </div>
          <div class="addrBtns">
            <button class="btn btnSm" type="button" data-copy="${label.toLowerCase()}:0">Copy full</button>
            <button class="btn btnSm btnGhost" type="button" data-qr="${label.toLowerCase()}:0">QR</button>
          </div>
        `;
      };

      renderVerify(vBtc, btcList, "BTC");
      renderVerify(vEth, ethList, "ETH");
    }

    function renderWallets(r){
      const grid = document.getElementById("walletGrid");
      grid.innerHTML = "";

      const wallets = [
        { key:"metamask", label:"MetaMask", note:"Use these chain-specific addresses in MetaMask (ETH, L2s, SOL, BTC).", coins:["eth","btc","sol","arbitrum","base","linea","polygon","op","bnb","sei"] },
        { key:"atomicwallet", label:"Atomic Wallet", note:"Paste chain addresses into Atomic Wallet; QR works too.", coins:["btc","eth","glmr","dogs","justachilguy","btt","ada","shibarium","shib","zec","hex","nexo","chz","arbitrum","chaingpt","xaut","eth_arb","eth_linea"] }
      ];

      wallets.forEach((w) => {
        const card = document.createElement("div");
        card.className = "walletCard";
        const brand = brandTheme(w.key);
        const uses = w.coins.flatMap((c) => walletAddrs(w.key, c).map((addr, idx) => ({ coin:c, addr, idx })));
        card.style.borderColor = brand.fade || "rgba(255,255,255,.12)";
        card.style.background = `linear-gradient(135deg, ${brand.fade || "rgba(255,255,255,.04)"}, rgba(0,0,0,.18))`;

        card.innerHTML = `
          <div class="walletTop">
            <div style="display:flex; align-items:center; gap:10px;">
              <span class="walletIcon" style="--brand-color:${brand.color};">${brand.icon}</span>
              <div>
                <p class="walletTitle">${w.label}</p>
                <p class="walletNote">${w.note}</p>
              </div>
            </div>
          </div>
          <div class="walletAddrs"></div>
        `;

        const listEl = card.querySelector(".walletAddrs");
        if(!uses.length){
          const row = document.createElement("div");
          row.className = "walletRow";
          row.innerHTML = `<div><div class="walletLabel">Not configured</div><div class="addrVal">Add BTC/ETH in config.json</div></div>`;
          listEl.appendChild(row);
        } else {
          uses.forEach((u) => {
            const row = document.createElement("div");
            const brand = brandTheme(u.coin.toLowerCase());
            row.className = "walletRow";
            row.style.borderLeft = `3px solid ${brand.color || "rgba(255,255,255,.18)"}`;
            row.style.background = `linear-gradient(120deg, ${brand.fade || "rgba(255,255,255,.06)"}, rgba(255,255,255,.02))`;
            row.innerHTML = `
              <div style="min-width:0;">
                <div class="walletLabel">${u.coin.toUpperCase()}${toList(r.crypto[u.coin]).length > 1 ? " #" + (u.idx+1) : ""}</div>
                <div class="addrVal">${u.addr}</div>
              </div>
              <div class="addrBtns">
                <button class="btn btnSm" type="button" data-copy="${u.coin}:${u.idx}">Copy</button>
                <button class="btn btnSm btnGhost" type="button" data-qr="${u.coin}:${u.idx}">QR</button>
              </div>
            `;
            listEl.appendChild(row);
          });
        }

        grid.appendChild(card);
      });
    }

    function renderWalletTable(walletKey, bodyId){
      const body = document.getElementById(bodyId);
      body.innerHTML = "";
      const wallet = rec().wallets?.[walletKey] || {};
      const entries = Object.entries(wallet);
      if(!entries.length){
        body.innerHTML = `<tr><td colspan="4" style="padding:12px;">No ${walletKey} addresses configured.</td></tr>`;
        return;
      }
      for(const [chain, val] of entries){
        const list = toList(val);
        if(!list.length) continue;
        const brand = brandTheme(chain.toLowerCase());
        list.forEach((addr, idx) => {
          const tr = document.createElement("tr");
          tr.style.background = `linear-gradient(90deg, ${brand.fade || "rgba(255,255,255,.06)"}, rgba(255,255,255,.02))`;
          tr.style.borderLeft = `3px solid ${brand.color || "rgba(255,255,255,.18)"}`;
          tr.innerHTML = `
            <td style="text-transform: uppercase; text-align:center;">
              <span class="miniIcon miniIconImg" style="--brand-color:${brand.color};">
                ${brand.remoteSvg
                  ? `<img class="brandSvg" src="${brand.remoteSvg}" data-fallback="${brand.svg || ""}" alt="${chainLabel(chain)} icon" loading="lazy" decoding="async" onerror="if(this.dataset.fallback){this.onerror=null;this.src=this.dataset.fallback;}" />`
                  : brand.svg ? `<img class="brandSvg" src="${brand.svg}" alt="${chainLabel(chain)} icon" loading="lazy" decoding="async" />` : brand.icon}
              </span>
            </td>
            <td style="text-transform: uppercase; font-weight: 900; color: rgba(245,245,255,.90);">
              <span class="miniIcon" style="--brand-color:${brand.color};">${brand.icon}</span>
              <span style="margin-left:8px;">${chainLabel(chain)}${list.length > 1 ? " #" + (idx+1) : ""}</span>
            </td>
            <td style="font-family: var(--mono); font-size: 12.5px; word-break: break-all; text-align:center;">${addr}</td>
            <td style="text-align:center;">
              <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:center;">
                <button class="btn btnSm" type="button" data-copyaddr="${addr}">Copy</button>
                <button class="btn btnSm btnGhost" type="button" data-qraddr="${addr}" data-qrchain="${chain}">QR</button>
              </div>
            </td>
          `;
          body.appendChild(tr);
        });
      }
      if(!body.children.length){
        body.innerHTML = `<tr><td colspan="4" style="padding:12px;">No ${walletKey} addresses configured.</td></tr>`;
      }
    }

    /* =========================
       APPLY RECIPIENT
       ========================= */
    function applyRecipient(){
      const r = rec();
      document.title = CFG.pageTitle;

      document.getElementById("selHandle").textContent = r.label;
      document.getElementById("heroTitle").textContent = `Support ${r.label}`;
      document.getElementById("heroCopy").textContent =
        `Unified donation hub for @0xElectron (DEV) and @0xLEANux (ORG). Current selection: ${r.label} (${r.kind}). Choose Sponsors/Card/PayPal/Crypto; Arch Corner included.`;

      setLink(document.getElementById("btnProfile"), r.profile);
      setLink(document.getElementById("btnSponsor"), r.sponsors);

      setLink(document.getElementById("ctaSponsors"), r.sponsors);
      setLink(document.getElementById("ctaCard"), r.card);
      setLink(document.getElementById("ctaPayPal"), r.paypal);

      const { configured, total } = methodTotals(r);
      document.getElementById("metaConfigured").textContent = `${configured}/${total}`;
      const recRail = recommendedRail(r);
      document.getElementById("metaRec").textContent = recRail.label;
      document.getElementById("metaRecNote").textContent = recRail.note;
      document.getElementById("metaDeep").textContent = `?to=${selected}`;
      renderCrypto(r);
      renderWallets(r);
      renderWalletTable("metamask", "metamaskTableBody");
      renderWalletTable("atomicwallet", "atomicTableBody");

      renderMethods();
      applyFilters();
      setActiveTab();
      localStorage.setItem("donate_to", selected);
    }

    /* =========================
       QR + COPY
       ========================= */
    function openQR(sym, idx=0){
      const r = rec();
      const addr = getAddr(sym, idx);
      if(!isConfigured(addr)){
        showToast("Address not configured for this recipient.");
        return;
      }

      const scheme = (sym === "btc") ? `bitcoin:${addr}` : `ethereum:${addr}`;
      const qrUrl = generateQRDataUrl(scheme);

      qrTitle.textContent = `QR • ${sym.toUpperCase()} • ${r.label}`;
      qrData.textContent = scheme;
      if(qrUrl){
        qrImg.src = qrUrl;
        qrImg.alt = `QR code for ${sym.toUpperCase()} ${r.label}`;
      }else{
        qrImg.removeAttribute("src");
        qrImg.alt = "QR unavailable; copy the address instead.";
      }

      qrCopy.onclick = async () => showToast((await copyText(scheme)) ? "Copied QR data." : "Copy failed.");
      qrCopyAddr.onclick = async () => showToast((await copyText(addr)) ? "Copied address." : "Copy failed.");

      qrModal.showModal();
    }

    /* =========================
       ARCH CORNER RENDER
       ========================= */
    function pickTip(){
      const tip = ARCH_TIPS[Math.floor(Math.random() * ARCH_TIPS.length)];
      document.getElementById("archTipText").textContent = tip;
    }

    function applyBackgroundStyle(){
      const choice = BG_STYLES[Math.floor(Math.random() * BG_STYLES.length)];
      document.documentElement.style.setProperty("--bg-layers", choice);
    }

    function renderCmds(){
      const root = document.getElementById("cmdList");
      root.innerHTML = "";

      PACMAN_CMDS.forEach((c) => {
        const el = document.createElement("div");
        el.className = "cmd";

        el.innerHTML = `
          <div class="cmdTop">
            <p class="cmdName" style="margin:0;">${c.name}</p>
            <div class="cmdActions">
              <button class="btn btnSm cmdCopy" type="button" data-copycmd="${encodeURIComponent(c.cmd)}">Copy</button>
            </div>
          </div>
          <p class="cmdDesc">${c.desc}</p>
          <div class="cmdCodeWrap">
            <div class="cmdCode">${c.cmd.replaceAll("<","&lt;").replaceAll(">","&gt;")}</div>
          </div>
        `;
        root.appendChild(el);
      });
    }

    /* =========================
       NON-MONEY ACTIONS
       ========================= */
    function handleNonMoney(action){
      const r = rec();
      switch(action){
        case "star":
          showToast("Stars help discoverability. Open your project repos and star the ones you use.");
          window.open(r.profile, "_blank", "noopener");
          break;
        case "issue":
          showToast("Bug reports help. Include logs, repro steps, and versions.");
          window.open(r.profile, "_blank", "noopener");
          break;
        case "pr":
          showToast("PRs welcome. Small doc fixes are high ROI.");
          window.open(r.profile, "_blank", "noopener");
          break;
        case "share":
          showToast("Shared. If you have a project page, paste this hub link there too.");
          copyText(CFG.hubCanonical.includes("YOUR_") ? window.location.href : CFG.hubCanonical).then(()=>{});
          break;
        case "packaging":
          showToast("Packaging help: PKGBUILD review, AUR maintenance, CI scripts, or mirrors. Strong impact.");
          break;
        default:
          showToast("Action saved.");
      }
    }

    /* =========================
       EVENTS
       ========================= */
    tabDev.addEventListener("click", () => { selected = "dev"; applyRecipient(); });
    tabOrg.addEventListener("click", () => { selected = "org"; applyRecipient(); });

    document.getElementById("search").addEventListener("input", applyFilters);
    document.getElementById("onlyConfigured").addEventListener("change", applyFilters);
    typeButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        filterType = btn.dataset.filterType || "all";
        typeButtons.forEach((b) => b.classList.toggle("active", b === btn));
        applyFilters();
      });
    });
    const currencyButtons = Array.from(document.querySelectorAll("[data-currency]"));
    currencyButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        selectedCurrency = btn.dataset.currency || "usd";
        currencyButtons.forEach((b) => b.classList.toggle("active", b === btn));
        renderOffers();
      });
    });

    document.getElementById("ctaCrypto").addEventListener("click", () => {
      const r = rec();
      if(isConfigured(r.crypto.btc)) openQR("btc");
      else openQR("eth");
    });

    document.getElementById("btnNewTip").addEventListener("click", pickTip);

    document.getElementById("btnArchMode").addEventListener("click", () => {
      document.getElementById("archBanner").classList.toggle("on");
      showToast("Arch banner toggled. This page is now 12% more Arch.");
    });

    document.addEventListener("keydown", (e) => {
      if(e.key && e.key.toLowerCase() === "a"){
        document.getElementById("archBanner").classList.toggle("on");
      }
    });

    document.addEventListener("click", async (e) => {
      const copyBtn = e.target.closest("[data-copy]");
      if(copyBtn){
        const [sym, idxStr] = (copyBtn.getAttribute("data-copy") || "").split(":");
        const addr = getAddr(sym, Number(idxStr) || 0);
        if(!isConfigured(addr)){ showToast("Address not configured."); return; }
        const ok = await copyText(addr);
        showToast(ok ? `${sym.toUpperCase()} copied.` : "Copy failed.");
        if(ok) pulseBtn(copyBtn);
        return;
      }

      const copyAddrBtn = e.target.closest("[data-copyaddr]");
      if(copyAddrBtn){
        const addr = copyAddrBtn.getAttribute("data-copyaddr") || "";
        const ok = await copyText(addr);
        showToast(ok ? "Address copied." : "Copy failed.");
        if(ok) pulseBtn(copyAddrBtn);
        return;
      }

      const qrBtn = e.target.closest("[data-qr]");
      if(qrBtn){
        const [sym, idxStr] = (qrBtn.getAttribute("data-qr") || "").split(":");
        openQR(sym, Number(idxStr) || 0);
        return;
      }

      const qrAddrBtn = e.target.closest("[data-qraddr]");
      if(qrAddrBtn){
        const addr = qrAddrBtn.getAttribute("data-qraddr") || "";
        const chain = (qrAddrBtn.getAttribute("data-qrchain") || "").toLowerCase();
        if(!isConfigured(addr)){ showToast("Address not configured."); return; }
        const scheme = chain === "btc" ? `bitcoin:${addr}` : chain.startsWith("eth") ? `ethereum:${addr}` : addr;
        const qrUrl = generateQRDataUrl(scheme);
        if(qrUrl){
          qrTitle.textContent = `QR • ${chain.toUpperCase() || "ADDR"}`;
          qrData.textContent = scheme;
          qrImg.src = qrUrl;
          qrModal.showModal();
        }else{
          showToast("QR unavailable; address copied instead.");
          copyText(addr);
        }
        return;
      }

      const cmdBtn = e.target.closest("[data-copycmd]");
      if(cmdBtn){
        const cmd = decodeURIComponent(cmdBtn.getAttribute("data-copycmd") || "");
        const ok = await copyText(cmd);
        showToast(ok ? "Command copied." : "Copy failed.");
        if(ok) pulseBtn(cmdBtn);
        return;
      }

      const actionBtn = e.target.closest("[data-action]");
      if(actionBtn){
        handleNonMoney(actionBtn.getAttribute("data-action"));
        return;
      }
    });

    document.getElementById("qrClose").addEventListener("click", () => qrModal.close());
    qrModal.addEventListener("click", (e) => {
      const r = qrModal.getBoundingClientRect();
      const inDialog = (r.top <= e.clientY && e.clientY <= r.bottom && r.left <= e.clientX && e.clientX <= r.right);
      if(!inDialog) qrModal.close();
    });

    /* =========================
       INIT
       ========================= */
    async function init(){
      CFG = await loadConfig();
      setupReveals();
      applyBackgroundStyle();
      document.getElementById("onlyConfigured").checked = true;
      renderOffers();
      renderCmds();
      pickTip();
      applyRecipient();
    }
    init();
  </script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("/donate/sw.js", { scope: "/donate/" }).catch(() => {});
      });
    }
  </script>

</body>
</html>
